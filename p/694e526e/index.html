<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>ã€Notesã€‘LLM API+Agent+FastAPI+SSE+Docker | Rean's Blog</title><noscript>å¼€å¯JavaScriptæ‰èƒ½è®¿é—®æœ¬ç«™å“¦~</noscript><link rel="icon" href="/img/favicon.png"><!-- index.css--><link rel="stylesheet" href="/css/index.css?v=1.8.10"><!-- inject head--><link rel="stylesheet" href="https://cdn2.codesign.qq.com/icons/7pOrz0WXB5ZWJPX/latest/iconfont.css"><!-- aplayer--><link rel="stylesheet" href="https://cdn.staticfile.net/aplayer/1.10.1/APlayer.min.css"><!-- swiper--><link rel="stylesheet" href="https://cdn.staticfile.net/Swiper/11.0.5/swiper-bundle.min.css"><!-- fancybox ui--><link rel="stylesheet" href="https://cdn.staticfile.net/fancyapps-ui/5.0.36/fancybox/fancybox.min.css"><!-- katex--><!-- Open Graph--><meta name="description" content="LLM APILLM API è¯·æ±‚ä½“å‚æ•° nï¼šé»˜è®¤1ï¼Œæ¯ä¸ªpromptç”Ÿæˆnä¸ªç»“æœã€‚ best_ofï¼šé»˜è®¤1ï¼Œåœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆbest_ofä¸ªå®Œæˆç»“æœï¼Œå¹¶è¿”å› â€œæœ€ä½³â€ ç»“æœï¼Œç»“æœæ— æ³•æµå¼ä¼ è¾“ã€‚ä¸nä¸€èµ·ä½¿ç”¨æ—¶ï¼Œbest_ofæ§åˆ¶å€™é€‰å®Œæˆç»“æœçš„æ•°é‡ï¼Œè€ŒnæŒ‡å®šè¦è¿”å›çš„æ•°é‡ï¼ˆæ­¤æ—¶best_ofå¿…é¡»å¤§äºnï¼‰ã€‚"><!-- pwa--><meta name="apple-mobile-web-app-capable" content="Rean's Blog"><meta name="theme-color" content="var(--efu-main)"><meta name="apple-mobile-web-app-status-bar-style" content="var(--efu-main)"><link rel="bookmark" href="/img/favicon.png"><link rel="apple-touch-icon" href="/img/favicon.png" sizes="180x180"><script>console.log(
    "%c Program: Hexo %c Theme: Solitude %c Version: v1.8.10",
    "border-radius:5px 0 0 5px;padding: 5px 10px;color:white;background:#ff3842;",
    "padding: 5px 10px;color:white;background:#3e9f50;",
    "padding: 5px 10px;color:white;background:#0084ff;",
)
</script><script>(()=>{
        const saveToLocal = {
            set: function setWithExpiry(key, value, ttl) {
                if (ttl === 0)
                    return
                const now = new Date()
                const expiryDay = ttl * 86400000
                const item = {
                    value: value,
                    expiry: now.getTime() + expiryDay
                }
                localStorage.setItem(key, JSON.stringify(item))
            },
            get: function getWithExpiry(key) {
                const itemStr = localStorage.getItem(key)
    
                if (!itemStr) {
                    return undefined
                }
                const item = JSON.parse(itemStr)
                const now = new Date()
    
                if (now.getTime() > item.expiry) {
                    localStorage.removeItem(key)
                    return undefined
                }
                return item.value
            }
        };
        window.utils = {
            saveToLocal: saveToLocal,
            getCSS: (url, id = false) => new Promise((resolve, reject) => {
              const link = document.createElement('link')
              link.rel = 'stylesheet'
              link.href = url
              if (id) link.id = id
              link.onerror = reject
              link.onload = link.onreadystatechange = function() {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                link.onload = link.onreadystatechange = null
                resolve()
              }
              document.head.appendChild(link)
            }),
            getScript: (url, attr = {}) => new Promise((resolve, reject) => {
              const script = document.createElement('script')
              script.src = url
              script.async = true
              script.onerror = reject
              script.onload = script.onreadystatechange = function() {
                const loadState = this.readyState
                if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
                script.onload = script.onreadystatechange = null
                resolve()
              }
    
              Object.keys(attr).forEach(key => {
                script.setAttribute(key, attr[key])
              })
    
              document.head.appendChild(script)
            }),
            addGlobalFn: (key, fn, name = false, parent = window) => {
                const globalFn = parent.globalFn || {}
                const keyObj = globalFn[key] || {}
        
                if (name && keyObj[name]) return
        
                name = name || Object.keys(keyObj).length
                keyObj[name] = fn
                globalFn[key] = keyObj
                parent.globalFn = globalFn
            },
        }
    })()</script><!-- global head--><script>const GLOBAL_CONFIG = {
    root: '/',
    algolia: undefined,
    localsearch: {"preload":false,"path":"/search.xml"},
    runtime: '2024-01-05 00:00:00',
    lazyload: {
        enable: true,
        error: '/img/error_load.png'
    },
    copyright: {"limit":50,"author":"ä½œè€…: Rean","link":"é“¾æ¥: ","source":"æ¥æº: Rean's Blog","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚ å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"},
    highlight: {
        enable: true,
        limit: 200,
        expand: true,
        copy: true,
        syntax: 'highlight.js'
    },
    randomlink: false,
    lang: {"theme":{"dark":"å·²åˆ‡æ¢è‡³æ·±è‰²æ¨¡å¼","light":"å·²åˆ‡æ¢è‡³æµ…è‰²æ¨¡å¼"},"copy":{"success":"å¤åˆ¶æˆåŠŸ","error":"å¤åˆ¶å¤±è´¥"},"backtop":"è¿”å›é¡¶éƒ¨","time":{"day":"å¤©å‰","hour":"å°æ—¶å‰","just":"åˆšåˆš","min":"åˆ†é’Ÿå‰","month":"ä¸ªæœˆå‰"},"f12":"å¼€å‘è€…æ¨¡å¼å·²æ‰“å¼€ï¼Œè¯·éµå¾ªGPLåè®®ã€‚","totalk":"æ— éœ€åˆ é™¤ç©ºè¡Œï¼Œç›´æ¥è¾“å…¥è¯„è®ºå³å¯","search":{"empty":"æ‰¾ä¸åˆ°ä½ æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hit":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’","placeholder":"è¾“å…¥å…³é”®è¯å¿«é€ŸæŸ¥æ‰¾","count":"å…± <b>${count}</b> æ¡ç»“æœã€‚"}},
    aside: {
        sayhello: {
            morning: 'ä¸€æ—¥ä¹‹è®¡åœ¨äºæ™¨',
            noon: 'åƒé¥±äº†æ‰æœ‰åŠ›æ°”å¹²æ´»',
            afternoon: 'é›†ä¸­ç²¾åŠ›ï¼Œæ”»å…‹éš¾å…³',
            night: 'ä¸è¦å¤ªåŠ³ç´¯äº†ï¼Œæ—©ç¡æ›´å¥åº·',
            goodnight: 'ç¡ä¸ªå¥½è§‰ï¼Œä¿è¯ç²¾åŠ›å……æ²›',
        },
        sayhello2: ["ğŸ¤–ï¸ æ•°ç ç§‘æŠ€çˆ±å¥½è€…","ğŸ” åˆ†äº«ä¸çƒ­å¿ƒå¸®åŠ©","ğŸ”¨ è®¾è®¡å¼€å‘ä¸€æ¡é¾™","ğŸ® æ¸¸æˆçˆ±å¥½è€…"],
    },
    covercolor: {
        enable: true
    },
    comment: false,
    lightbox: 'fancybox',
    post_ai: false,
    right_menu: {"mode":{"dark":"æ·±è‰²æ¨¡å¼","light":"æµ…è‰²æ¨¡å¼"},"img_error":"æ­¤å›¾ç‰‡æ— æ³•å¤åˆ¶ä¸ä¸‹è½½","music":{"start":"æ’­æ”¾éŸ³ä¹","stop":"æš‚åœéŸ³ä¹"},"translate":{"translateDelay":0,"defaultEncoding":2}},
};</script><!-- page-config head--><script id="config-diff">var PAGE_CONFIG = {
    is_post: true,
    is_page: false,
    is_home: false,
    page: '',
    toc: true,
    comment: false,
    ai_text: false,
}</script><meta name="generator" content="Hexo 7.2.0"></head><body id="body"><!-- universe--><canvas id="universe"></canvas><!-- loading--><!-- console--><div id="console"><div class="close-btn" onclick="sco.hideConsole()"><i class="solitude st-close-fill"></i></div><div class="button-group"><div class="console-btn-item"><span class="darkmode_switchbutton" onclick="sco.switchDarkMode()" title="æ˜¼å¤œåˆ‡æ¢"><i class="solitude st-moon-clear-fill"></i></span></div><div class="console-btn-item" id="consoleHideAside"><span class="asideSwitch" onclick="sco.switchHideAside()" title="è¾¹æ æ˜¾ç¤ºæ§åˆ¶"><i class="solitude st-side-bar-fill"></i></span></div><div class="console-btn-item" id="consoleMusic" onclick="sco.musicToggle()"><span class="music-switch" title="éŸ³ä¹å¼€å…³"><i class="solitude st-disc-fill"></i></span></div></div><div class="console-mask" onclick="sco.hideConsole()"></div></div><!-- sidebar--><div id="sidebar" style="zoom: 1;"><div id="menu-mask" style="display: none;"></div><div id="sidebar-menus"><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">182</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">11</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">160</div></a></div></div></div><span class="sidebar-menu-item-title">åŠŸèƒ½</span><div class="sidebar-menu-item"><span class="darkmode_switchbutton menu-child" onclick="sco.switchDarkMode()"><i class="solitude st-moon-clear-fill"></i><span>æ˜¾ç¤ºæ¨¡å¼</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>æ–‡ç« </span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  st-folder-fill"></i><span>æ–‡ç« åˆ—è¡¨</span></a></li><li><a class="site-page child" href="/categories/"><i class="solitude  st-checkbox-multiple-blank-fill"></i><span>åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  st-price-tag-fill"></i><span>æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/study/"><i class="solitude  st-gift-fill"></i><span>å­¦ä¹ </span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>æˆ‘çš„</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="solitude  st-disc-fill"></i><span>éŸ³ä¹é¦†</span></a></li><li><a class="site-page child" href="/essay/"><span>å³åˆ»çŸ­æ–‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>å…³äº</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="solitude  st-contacts-fill"></i><span>å…³äºæœ¬ç«™</span></a></li></ul></div></div><span class="sidebar-menu-item-title">æ ‡ç­¾</span><div class="card-widget card-tags card-archives card-webinfo card-allinfo"><div class="card-tag-cloud"><a href="/tags/%E8%85%BE%E8%AE%AF/">è…¾è®¯<sup>1</sup></a><a href="/tags/%E5%90%8E%E5%8F%B0%E5%BC%80%E5%8F%91/">åå°å¼€å‘<sup>1</sup></a><a href="/tags/Markdown/">Markdown<sup>1</sup></a><a href="/tags/Butterfly/">Butterfly<sup>2</sup></a><a href="/tags/PyCharm/">PyCharm<sup>1</sup></a><a href="/tags/IDEA/">IDEA<sup>1</sup></a><a href="/tags/Git/">Git<sup>2</sup></a><a href="/tags/Halo/">Halo<sup>1</sup></a><a href="/tags/GitHub/">GitHub<sup>1</sup></a><a href="/tags/JavaFx/">JavaFx<sup>2</sup></a><a href="/tags/SpringBoot/">SpringBoot<sup>7</sup></a><a href="/tags/Java/">Java<sup>18</sup></a><a href="/tags/MyBatis/">MyBatis<sup>4</sup></a><a href="/tags/Hexo/">Hexo<sup>3</sup></a><a href="/tags/SyncTV/">SyncTV<sup>1</sup></a><a href="/tags/AList/">AList<sup>1</sup></a><a href="/tags/%E5%AE%9D%E5%A1%94/">å®å¡”<sup>3</sup></a><a href="/tags/Vue/">Vue<sup>18</sup></a><a href="/tags/Vite/">Vite<sup>6</sup></a><a href="/tags/JavaScript/">JavaScript<sup>4</sup></a><a href="/tags/TypeScript/">TypeScript<sup>3</sup></a><a href="/tags/Electron/">Electron<sup>4</sup></a><a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ <sup>1</sup></a><a href="/tags/scikit-learn/">scikit-learn<sup>1</sup></a><a href="/tags/vocalremover/">vocalremover<sup>1</sup></a><a href="/tags/BPM/">BPM<sup>1</sup></a><a href="/tags/%E9%BB%91%E7%A5%9E%E8%AF%9D%EF%BC%9A%E6%82%9F%E7%A9%BA/">é»‘ç¥è¯ï¼šæ‚Ÿç©º<sup>1</sup></a><a href="/tags/HTTP/">HTTP<sup>5</sup></a><a href="/tags/HTTPS/">HTTPS<sup>2</sup></a><a href="/tags/%E7%9F%AD%E9%93%BE/">çŸ­é“¾<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91/">è§†é¢‘<sup>1</sup></a><a href="/tags/HTTP-1-1/">HTTP/1.1<sup>1</sup></a><a href="/tags/LaTex/">LaTex<sup>1</sup></a><a href="/tags/%E5%8A%A0%E5%AF%86/">åŠ å¯†<sup>1</sup></a><a href="/tags/IP/">IP<sup>2</sup></a><a href="/tags/ICMP/">ICMP<sup>1</sup></a><a href="/tags/I-O/">I/O<sup>2</sup></a><a href="/tags/JVM/">JVM<sup>2</sup></a><a href="/tags/Springboot/">Springboot<sup>1</sup></a><a href="/tags/ThreadLocal/">ThreadLocal<sup>1</sup></a><a href="/tags/UUID/">UUID<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91/">å¹¶å‘<sup>4</sup></a><a href="/tags/%E7%BA%A2%E9%BB%91%E6%A0%91/">çº¢é»‘æ ‘<sup>2</sup></a><a href="/tags/%E9%93%BE%E8%A1%A8/">é“¾è¡¨<sup>1</sup></a><a href="/tags/%E5%8A%9B%E6%89%A3/">åŠ›æ‰£<sup>1</sup></a><a href="/tags/LeetCode/">LeetCode<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“<sup>8</sup></a><a href="/tags/NLP/">NLP<sup>6</sup></a><a href="/tags/spaCy/">spaCy<sup>4</sup></a><a href="/tags/Python/">Python<sup>1</sup></a><a href="/tags/Redis/">Redis<sup>10</sup></a><a href="/tags/RDB/">RDB<sup>1</sup></a><a href="/tags/AOF/">AOF<sup>1</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B/">çº¿ç¨‹<sup>2</sup></a><a href="/tags/I-O%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8/">I/Oå¤šè·¯å¤ç”¨<sup>2</sup></a><a href="/tags/Spring/">Spring<sup>5</sup></a><a href="/tags/TCP/">TCP<sup>7</sup></a><a href="/tags/UDP/">UDP<sup>1</sup></a><a href="/tags/Socket/">Socket<sup>1</sup></a><a href="/tags/FFMpeg/">FFMpeg<sup>1</sup></a><a href="/tags/%E6%A0%B7%E5%BC%8F/">æ ·å¼<sup>1</sup></a><a href="/tags/ECMAScript/">ECMAScript<sup>2</sup></a><a href="/tags/Element/">Element<sup>3</sup></a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/">åˆ†å¸ƒå¼é”<sup>1</sup></a><a href="/tags/%E5%91%A8%E6%B7%B1/">å‘¨æ·±<sup>7</sup></a><a href="/tags/%E5%BE%B5%E7%BE%BD%E6%91%A9%E6%9F%AF/">å¾µç¾½æ‘©æŸ¯<sup>1</sup></a><a href="/tags/%E9%9F%B3%E4%B9%90%E7%BC%98%E8%AE%A1%E5%88%92/">éŸ³ä¹ç¼˜è®¡åˆ’<sup>4</sup></a><a href="/tags/%E5%A5%A5%E6%96%AF%E5%8D%A1/">å¥¥æ–¯å¡<sup>3</sup></a><a href="/tags/%E5%BC%A0%E6%9D%B0/">å¼ æ°<sup>2</sup></a><a href="/tags/%E5%A3%B0%E7%94%9F%E4%B8%8D%E6%81%AF%C2%B7%E5%AE%9D%E5%B2%9B%E5%AD%A3/">å£°ç”Ÿä¸æ¯Â·å®å²›å­£<sup>3</sup></a><a href="/tags/%E5%BE%90%E4%BD%B3%E8%8E%B9/">å¾ä½³è¹<sup>1</sup></a><a href="/tags/SynthV/">SynthV<sup>22</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">æ“ä½œç³»ç»Ÿ<sup>4</sup></a><a href="/tags/%E6%B0%B8%E5%A4%9CMinus/">æ°¸å¤œMinus<sup>6</sup></a><a href="/tags/%E9%9F%A6%E7%A4%BC%E5%AE%89/">éŸ¦ç¤¼å®‰<sup>1</sup></a><a href="/tags/%E8%94%A1%E4%BE%9D%E6%9E%97/">è”¡ä¾æ—<sup>1</sup></a><a href="/tags/%E6%97%A0%E5%8F%82/">æ— å‚<sup>46</sup></a><a href="/tags/%E5%8F%A4%E9%A3%8E/">å¤é£<sup>12</sup></a><a href="/tags/%E4%B8%89%E6%97%A0Marblue/">ä¸‰æ— Marblue<sup>1</sup></a><a href="/tags/%E7%B4%A2%E5%BC%95/">ç´¢å¼•<sup>1</sup></a><a href="/tags/B%E6%A0%91/">Bæ ‘<sup>1</sup></a><a href="/tags/B-%E6%A0%91/">B+æ ‘<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">æ•°æ®ç»“æ„<sup>1</sup></a><a href="/tags/%E6%A0%91/">æ ‘<sup>1</sup></a><a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/">äºŒå‰æ ‘<sup>1</sup></a><a href="/tags/%E8%AE%B8%E9%92%A7/">è®¸é’§<sup>1</sup></a><a href="/tags/%E6%AD%8C%E6%89%8B2024/">æ­Œæ‰‹2024<sup>37</sup></a><a href="/tags/Chante-Moore/">ChantÃ© Moore<sup>2</sup></a><a href="/tags/%E9%BB%84%E5%AE%A3/">é»„å®£<sup>1</sup></a><a href="/tags/Faouzia/">Faouzia<sup>4</sup></a><a href="/tags/Lenka/">Lenka<sup>1</sup></a><a href="/tags/%E5%BC%A0%E9%92%B0%E7%90%AA/">å¼ é’°çª<sup>1</sup></a><a href="/tags/%E9%82%A3%E8%8B%B1/">é‚£è‹±<sup>9</sup></a><a href="/tags/%E5%B0%A4%E9%95%BF%E9%9D%96/">å°¤é•¿é–<sup>2</sup></a><a href="/tags/%E5%AD%99%E6%A5%A0/">å­™æ¥ <sup>5</sup></a><a href="/tags/%E8%B0%AD%E7%BB%B4%E7%BB%B4/">è°­ç»´ç»´<sup>3</sup></a><a href="/tags/%E5%B4%A9%E5%9D%8F%EF%BC%9A%E6%98%9F%E7%A9%B9%E9%93%81%E9%81%93/">å´©åï¼šæ˜Ÿç©¹é“é“<sup>4</sup></a><a href="/tags/%E8%B5%A4%E7%BE%BD/">èµ¤ç¾½<sup>1</sup></a><a href="/tags/%E6%B1%AA%E8%8B%8F%E6%B3%B7/">æ±ªè‹æ³·<sup>4</sup></a><a href="/tags/%E5%A3%B0%E7%94%9F%E4%B8%8D%E6%81%AF%C2%B7%E5%AE%B6%E5%B9%B4%E5%8D%8E/">å£°ç”Ÿä¸æ¯Â·å®¶å¹´å<sup>3</sup></a><a href="/tags/%E9%99%88%E6%A5%9A%E7%94%9F/">é™ˆæ¥šç”Ÿ<sup>3</sup></a><a href="/tags/%E9%99%88%E4%BA%A6%E6%B4%BA/">é™ˆäº¦æ´º<sup>1</sup></a><a href="/tags/%E5%B0%9A%E8%BE%B0/">å°šè¾°<sup>1</sup></a><a href="/tags/%E5%BF%98%E5%B7%9D%E9%A3%8E%E5%8D%8E%E5%BD%95/">å¿˜å·é£åå½•<sup>2</sup></a><a href="/tags/%E4%B9%90%E6%AD%A3%E9%BE%99%E7%89%99/">ä¹æ­£é¾™ç‰™<sup>1</sup></a><a href="/tags/%E6%98%9F%E5%B0%98Infinity/">æ˜Ÿå°˜Infinity<sup>4</sup></a><a href="/tags/%E6%98%8E%E6%97%A5%E6%96%B9%E8%88%9F/">æ˜æ—¥æ–¹èˆŸ<sup>3</sup></a><a href="/tags/%E7%A5%96%E5%A8%85%E7%BA%B3%E6%83%9C/">ç¥–å¨…çº³æƒœ<sup>1</sup></a><a href="/tags/%E7%94%B5%E5%AD%90/">ç”µå­<sup>1</sup></a><a href="/tags/%E6%98%9F%E5%B0%98/">æ˜Ÿå°˜<sup>6</sup></a><a href="/tags/%E5%BC%A0%E4%BF%A1%E5%93%B2/">å¼ ä¿¡å“²<sup>2</sup></a><a href="/tags/%E9%93%B6%E4%B8%B4/">é“¶ä¸´<sup>1</sup></a><a href="/tags/%E6%9D%8E%E5%B8%B8%E8%B6%85/">æå¸¸è¶…<sup>1</sup></a><a href="/tags/%E5%B1%B1%E8%89%B2%E6%9C%89%E6%97%A0%E4%B8%AD/">å±±è‰²æœ‰æ— ä¸­<sup>1</sup></a><a href="/tags/%E5%91%A8%E6%9D%B0%E4%BC%A6/">å‘¨æ°ä¼¦<sup>1</sup></a><a href="/tags/%E9%BB%84%E9%9C%84%E9%9B%B2/">é»„éœ„é›²<sup>1</sup></a><a href="/tags/%E5%AE%B9%E7%A5%96%E5%84%BF/">å®¹ç¥–å„¿<sup>1</sup></a><a href="/tags/%E6%88%91%E6%98%AF%E6%AD%8C%E6%89%8B%C2%B7%E7%AC%AC%E5%9B%9B%E5%AD%A3/">æˆ‘æ˜¯æ­Œæ‰‹Â·ç¬¬å››å­£<sup>1</sup></a><a href="/tags/%E6%9D%8E%E5%85%8B%E5%8B%A4/">æå…‹å‹¤<sup>1</sup></a><a href="/tags/%E7%B2%A4%E8%AF%AD/">ç²¤è¯­<sup>2</sup></a><a href="/tags/%E9%BB%84%E4%B8%BD%E7%8E%B2/">é»„ä¸½ç²<sup>1</sup></a><a href="/tags/G-E-M-%E9%82%93%E7%B4%AB%E6%A3%8B/">G.E.M.é‚“ç´«æ£‹<sup>7</sup></a><a href="/tags/T-I-M-E/">T.I.M.E.<sup>4</sup></a><a href="/tags/%E6%97%B6%E5%85%89%E9%9F%B3%E4%B9%90%E4%BC%9A%C2%B7%E8%80%81%E5%8F%8B%E8%AE%B0/">æ—¶å…‰éŸ³ä¹ä¼šÂ·è€å‹è®°<sup>5</sup></a><a href="/tags/%E5%BC%A0%E5%AD%A6%E5%8F%8B/">å¼ å­¦å‹<sup>1</sup></a><a href="/tags/%E6%9D%A8%E4%B8%9E%E7%90%B3/">æ¨ä¸ç³<sup>1</sup></a><a href="/tags/%E6%B1%AA%E5%B3%B0/">æ±ªå³°<sup>1</sup></a><a href="/tags/%E6%9C%AA%E5%AE%9A%E4%BA%8B%E4%BB%B6%E7%B0%BF/">æœªå®šäº‹ä»¶ç°¿<sup>1</sup></a><a href="/tags/%E5%BC%A0%E8%BF%9C/">å¼ è¿œ<sup>1</sup></a><a href="/tags/%E5%AD%99%E7%87%95%E5%A7%BF/">å­™ç‡•å§¿<sup>2</sup></a><a href="/tags/%E6%B5%B7%E6%9D%A5%E9%98%BF%E6%9C%A8/">æµ·æ¥é˜¿æœ¨<sup>1</sup></a><a href="/tags/%E6%9B%B9%E6%9D%A8/">æ›¹æ¨<sup>3</sup></a><a href="/tags/%E4%B8%8B%E4%B8%80%E6%88%98%E6%AD%8C%E6%89%8B/">ä¸‹ä¸€æˆ˜æ­Œæ‰‹<sup>3</sup></a><a href="/tags/Fine%E4%B9%90%E5%9B%A2/">Fineä¹å›¢<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">è®¡ç®—æœºç½‘ç»œ<sup>4</sup></a><a href="/tags/DNS/">DNS<sup>1</sup></a><a href="/tags/MAC/">MAC<sup>1</sup></a><a href="/tags/Adam-Lambert/">Adam Lambert<sup>1</sup></a><a href="/tags/%E4%BA%9A%E5%BD%93%C2%B7%E5%85%B0%E4%BC%AF%E7%89%B9/">äºšå½“Â·å…°ä¼¯ç‰¹<sup>1</sup></a><a href="/tags/Hayden/">Hayden<sup>1</sup></a><a href="/tags/%E6%9A%AE%E5%A4%9C/">æš®å¤œ<sup>1</sup></a><a href="/tags/ACE-Studio/">ACE Studio<sup>3</sup></a><a href="/tags/%E5%B0%9A%E9%9B%AF%E5%A9%95/">å°šé›¯å©•<sup>1</sup></a><a href="/tags/%E4%B8%9C%E6%96%B9%E6%A0%80%E5%AD%90/">ä¸œæ–¹æ €å­<sup>2</sup></a><a href="/tags/%E9%BB%84%E7%BB%AE%E7%8F%8A/">é»„ç»®çŠ<sup>1</sup></a><a href="/tags/%E5%8D%8E%E6%99%A8%E5%AE%87/">åæ™¨å®‡<sup>1</sup></a><a href="/tags/JUN/">JUN<sup>1</sup></a><a href="/tags/%E6%9E%97%E5%BF%86%E8%8E%B2/">æ—å¿†è²<sup>1</sup></a><a href="/tags/UTAU/">UTAU<sup>1</sup></a><a href="/tags/Sheena/">Sheena<sup>1</sup></a><a href="/tags/%E5%89%A7%E5%A5%BD%E5%90%AC%E7%9A%84%E6%AD%8C/">å‰§å¥½å¬çš„æ­Œ<sup>1</sup></a><a href="/tags/Syncthing/">Syncthing<sup>1</sup></a><a href="/tags/%E5%90%8C%E6%AD%A5/">åŒæ­¥<sup>1</sup></a><a href="/tags/%E6%94%AF%E4%BB%98%E5%AE%9D/">æ”¯ä»˜å®<sup>1</sup></a><a href="/tags/Apifox/">Apifox<sup>2</sup></a><a href="/tags/%E5%B2%B8%E6%99%93/">å²¸æ™“<sup>1</sup></a><a href="/tags/%E5%8D%95%E4%BE%9D%E7%BA%AF/">å•ä¾çº¯<sup>2</sup></a><a href="/tags/%E9%BB%84%E5%AD%90%E5%BC%98%E5%87%A1/">é»„å­å¼˜å‡¡<sup>1</sup></a><a href="/tags/%E5%A2%A8%E6%B8%85%E5%BC%A6/">å¢¨æ¸…å¼¦<sup>1</sup></a><a href="/tags/%E6%AD%8C%E6%89%8B2025/">æ­Œæ‰‹2025<sup>1</sup></a></div></div></div></div><!-- keyboard--><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav class="show" id="nav"><div id="nav-group"><div id="blog_name"><a id="site-name" href="/" title="è¿”å›åšå®¢ä¸»é¡µ"><span class="title">Rean's Blog</span></a></div><div id="page-name-mask"><div id="page-name"><a id="page-name-text" onclick="sco.toTop()">ã€Notesã€‘LLM API+Agent+FastAPI+SSE+Docker</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>æ–‡ç« </span></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="solitude  st-folder-fill"></i><span>æ–‡ç« åˆ—è¡¨</span></a></li><li><a class="site-page child" href="/categories/"><i class="solitude  st-checkbox-multiple-blank-fill"></i><span>åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="solitude  st-price-tag-fill"></i><span>æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/study/"><i class="solitude  st-gift-fill"></i><span>å­¦ä¹ </span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>æˆ‘çš„</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="solitude  st-disc-fill"></i><span>éŸ³ä¹é¦†</span></a></li><li><a class="site-page child" href="/essay/"><span>å³åˆ»çŸ­æ–‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span>å…³äº</span></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="solitude  st-contacts-fill"></i><span>å…³äºæœ¬ç«™</span></a></li></ul></div></div></div><div id="nav-left"></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="éšæœºä¸€ç¯‡æ–‡ç« " href="javascript:void(0);"><i class="solitude st-signal-tower-fill"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="æœç´¢"><i class="solitude st-search-line"></i></a></div><div class="nav-button" id="nav-console"><a class="console_switchbutton" onclick="sco.showConsole()" title="ä¸­æ§å°" href="javascript:void(0);"><i class="solitude st-dashboard-fill"></i></a></div><div class="nav-button" id="nav-totop" onclick="sco.toTop()"><a class="totopbtn"><i class="solitude st-arrow-up-line"></i><span id="percent">0</span></a></div><div id="toggle-menu"><a class="site-page"><i class="solitude st-menu-line"></i></a></div></div></div></nav><div class="coverdiv" id="coverdiv"><img class="nolazyload" id="post-cover" src="https://npm.elemecdn.com/justlovesmile-photo/cover8.JPG" alt="ã€Notesã€‘LLM API+Agent+FastAPI+SSE+Docker"></div><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original" title="è¯¥æ–‡ç« ä¸ºåŸåˆ›æ–‡ç« ï¼Œæ³¨æ„ç‰ˆæƒåè®®">åŸåˆ›</a><span class="post-meta-categories"><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/">å­¦ä¹ </a></span><div class="tag_share"><div class="post-meta__tag-list"></div></div></div></div><h1 class="post-title">ã€Notesã€‘LLM API+Agent+FastAPI+SSE+Docker</h1><div id="post-meta"><div class="meta-secondline"><span class="post-meta-date" title="å‘å¸ƒäº 2025-07-21 10:49:51"><i class="post-meta-icon solitude st-calendar-todo-fill"></i><time datetime="2025-07-21T02:49:51.000Z">2025-07-21T02:49:51.000Z</time></span><span class="post-meta-date" title="æœ€åæ›´æ–°äº 2025-07-24 11:17:26"><i class="post-meta-icon solitude st-refresh-line"></i><time datetime="2025-07-24T03:17:26.312Z">2025-07-24T03:17:26.312Z</time></span><span class="post-meta-wordcount"><i class="post-meta-icon solitude st-word-fill" title="æ–‡ç« å­—æ•°"></i><span class="word-count">6.7k</span><span class="post-meta-separator"></span><i class="post-meta-icon solitude st-clock-fill" title="é˜…è¯»è€—æ—¶"></i><span>32 min</span></span><a class="post-meta-pv" href="/p/694e526e/" title="æ–‡ç« çƒ­åº¦"><i class="post-meta-icon solitude st-fire-fill"></i><span id="busuanzi_page_pv"><i class="solitude st-loading-line"></i></span></a></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="LLM-API"><a href="#LLM-API" class="headerlink" title="LLM API"></a>LLM API</h1><h2 id="LLM-API-è¯·æ±‚ä½“å‚æ•°"><a href="#LLM-API-è¯·æ±‚ä½“å‚æ•°" class="headerlink" title="LLM API è¯·æ±‚ä½“å‚æ•°"></a>LLM API è¯·æ±‚ä½“å‚æ•°</h2><ul>
<li><code>n</code>ï¼šé»˜è®¤1ï¼Œæ¯ä¸ªpromptç”Ÿæˆ<code>n</code>ä¸ªç»“æœã€‚</li>
<li><code>best_of</code>ï¼šé»˜è®¤1ï¼Œåœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆ<code>best_of</code>ä¸ªå®Œæˆç»“æœï¼Œå¹¶è¿”å› â€œæœ€ä½³â€ ç»“æœï¼Œç»“æœæ— æ³•æµå¼ä¼ è¾“ã€‚ä¸<code>n</code>ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œ<code>best_of</code>æ§åˆ¶å€™é€‰å®Œæˆç»“æœçš„æ•°é‡ï¼Œè€Œ<code>n</code>æŒ‡å®šè¦è¿”å›çš„æ•°é‡ï¼ˆæ­¤æ—¶<code>best_of</code>å¿…é¡»å¤§äº<code>n</code>ï¼‰ã€‚</li>
<li><code>logit_bias</code>ï¼šä¿®æ”¹æŒ‡å®štokenå‡ºç°åœ¨å®Œæˆç»“æœä¸­çš„å¯èƒ½æ€§ã€‚æ¥å—ä¸€ä¸ªJSONå¯¹è±¡ï¼Œå°†tokenï¼ˆé€šè¿‡token IDæŒ‡å®šï¼‰æ˜ å°„åˆ° -100 åˆ° 100 ä¹‹é—´çš„ç›¸å…³åå·®å€¼ã€‚ -1 åˆ° 1 ä¹‹é—´çš„å€¼åº”è¯¥ä¼šé™ä½æˆ–å¢åŠ é€‰æ‹©çš„å¯èƒ½æ€§ï¼› -100 æˆ– 100 è¿™æ ·çš„å€¼åº”è¯¥ä¼šå¯¼è‡´ç›¸å…³tokenè¢«ç¦æ­¢å‡ºç°æˆ–è¢«å”¯ä¸€é€‰æ‹©ã€‚ ä¾‹å¦‚ï¼Œä¼ å…¥<code>&#123;&quot;50256&quot;: -100&#125;</code>å¯ä»¥é˜²æ­¢ç”Ÿæˆ<code>&lt;|endoftext|&gt;</code>çš„tokenã€‚</li>
<li><code>logprobs</code>ï¼šæœ€å¤§å€¼5ï¼Œè¾“å‡º<code>logprobs</code>ä¸ªæœ€æœ‰å¯èƒ½çš„ token åŠå…¶å¯¹åº”æ¦‚ç‡ï¼Œä¾‹å¦‚<code>logprobs</code>ä¸º 5ï¼ŒAPI å°†è¿”å› 5 ä¸ªæœ€æœ‰å¯èƒ½çš„è¯å…ƒçš„åˆ—è¡¨ã€‚</li>
<li><code>frequency_penalty</code>ï¼šå¯¹æ–° token å‡ºç°é¢‘ç‡çš„æƒ©ç½šå€¼ï¼ŒèŒƒå›´<code>[-2.0, 2.0]</code>ã€‚å€¼ &gt; 0 é¼“åŠ±æ¨¡å‹ä½¿ç”¨æ–° tokenï¼Œè€Œå€¼ &lt; 0 é¼“åŠ±æ¨¡å‹é‡å¤ tokenã€‚</li>
<li><code>presence_penalty</code>ï¼šæ˜¯å¦å‡ºç°æ–° token çš„æƒ©ç½šå€¼ï¼ŒèŒƒå›´<code>[-2.0, 2.0]</code>ã€‚å€¼ &gt; 0 é¼“åŠ±æ¨¡å‹ä½¿ç”¨æ–° tokenï¼Œå€¼ &lt; 0 é¼“åŠ±æ¨¡å‹é‡å¤ tokenã€‚</li>
<li><code>seed</code>ï¼šç”¨äºç”Ÿæˆçš„éšæœºç§å­ã€‚</li>
<li><code>suffix</code>ï¼šç”¨äºåœ¨ç”Ÿæˆçš„æ–‡æœ¬åæ·»åŠ ä¸€æ®µå›ºå®šçš„åç¼€ã€‚</li>
<li><code>temperature</code>ï¼šé»˜è®¤1ï¼Œæ§åˆ¶é‡‡æ ·éšæœºæ€§çš„æµ®ç‚¹æ•°ï¼ŒèŒƒå›´<code>[0, 2]</code>ã€‚è¾ƒä½çš„å€¼ä½¿æ¨¡å‹æ›´å…·ç¡®å®šæ€§ï¼Œè¾ƒé«˜çš„å€¼ä½¿æ¨¡å‹æ›´å…·éšæœºæ€§ã€‚å€¼ä¸º 0 è¡¨ç¤ºè´ªå©ªé‡‡æ ·ã€‚</li>
<li><code>top_p</code>ï¼šé»˜è®¤1ï¼Œæ ¸é‡‡æ ·ï¼Œæ¨¡å‹ä¼šè€ƒè™‘æ¦‚ç‡è´¨é‡åœ¨å‰ <code>top_p</code> çš„ token çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œ0.1 æ„å‘³ç€åªè€ƒè™‘æ¦‚ç‡è´¨é‡åœ¨å‰ 10% çš„ tokenã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> dotenv <span class="keyword">import</span> load_dotenv</span><br><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line"></span><br><span class="line">load_dotenv()</span><br><span class="line">client = OpenAI(</span><br><span class="line">        base_url=os.getenv(<span class="string">&quot;BAILIAN_API_BASE_URL&quot;</span>),</span><br><span class="line">        api_key=os.getenv(<span class="string">&quot;BAILIAN_API_KEY&quot;</span>)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">response = client.chat.completions.create(</span><br><span class="line">        model=model,</span><br><span class="line">        messages=prompt,</span><br><span class="line">        max_tokens=<span class="number">500</span>,</span><br><span class="line">        temperature=<span class="number">0.7</span>,</span><br><span class="line">        stop=[<span class="string">&quot;ç”¨æˆ·ï¼š&quot;</span>],  <span class="comment"># é˜²æ­¢æ¨¡å‹ç”Ÿæˆç”¨æˆ·çš„å‘è¨€</span></span><br><span class="line">        extra_body=&#123;<span class="string">&quot;enable_thinking&quot;</span>: <span class="literal">False</span>&#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>



<h2 id="ç»“æ„åŒ–è¾“å‡º"><a href="#ç»“æ„åŒ–è¾“å‡º" class="headerlink" title="ç»“æ„åŒ–è¾“å‡º"></a>ç»“æ„åŒ–è¾“å‡º</h2><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><ol>
<li><p>å®šä¹‰Json Schema</p>
</li>
<li><p>æŒ‡å®š<code>text.format</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">text: &#123; <span class="built_in">format</span>: &#123; <span class="built_in">type</span>: <span class="string">&quot;json_schema&quot;</span>, <span class="string">&quot;strict&quot;</span>: true, <span class="string">&quot;schema&quot;</span>: â€¦ &#125; &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¤„ç†è¾¹ç•Œæƒ…å†µ</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">response = client.responses.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-4o-2024-08-06&quot;</span>,</span><br><span class="line">    <span class="built_in">input</span>=[</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a helpful math tutor. Guide the user through the solution step by step.&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;how can I solve 8x + 7 = -23&quot;</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    text=&#123;</span><br><span class="line">        <span class="string">&quot;format&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;type&quot;</span>: <span class="string">&quot;json_schema&quot;</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;math_response&quot;</span>,</span><br><span class="line">            <span class="string">&quot;schema&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">                <span class="string">&quot;properties&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;steps&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;array&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;items&quot;</span>: &#123;</span><br><span class="line">                            <span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;properties&quot;</span>: &#123;</span><br><span class="line">                                <span class="string">&quot;explanation&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>&#125;,</span><br><span class="line">                                <span class="string">&quot;output&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>&#125;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            <span class="string">&quot;required&quot;</span>: [<span class="string">&quot;explanation&quot;</span>, <span class="string">&quot;output&quot;</span>],</span><br><span class="line">                            <span class="string">&quot;additionalProperties&quot;</span>: <span class="literal">False</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="string">&quot;final_answer&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>&#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">&quot;required&quot;</span>: [<span class="string">&quot;steps&quot;</span>, <span class="string">&quot;final_answer&quot;</span>],</span><br><span class="line">                <span class="string">&quot;additionalProperties&quot;</span>: <span class="literal">False</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;strict&quot;</span>: <span class="literal">True</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response.output_text)</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="æ”¯æŒçš„-Schema"><a href="#æ”¯æŒçš„-Schema" class="headerlink" title="æ”¯æŒçš„ Schema"></a>æ”¯æŒçš„ Schema</h3><ul>
<li>String</li>
<li>Number</li>
<li>Boolean</li>
<li>Integer</li>
<li>Object</li>
<li>Array</li>
<li>Enum</li>
<li>anyOf</li>
</ul>
<h4 id="æ”¯æŒçš„å±æ€§"><a href="#æ”¯æŒçš„å±æ€§" class="headerlink" title="æ”¯æŒçš„å±æ€§"></a>æ”¯æŒçš„å±æ€§</h4><h5 id="string"><a href="#string" class="headerlink" title="string"></a>string</h5><ul>
<li><p><code>pattern</code>ï¼šæ­£åˆ™è¡¨è¾¾å¼</p>
</li>
<li><p><code>format</code>ï¼šé¢„å®šä¹‰çš„æ ¼å¼</p>
<ul>
<li><code>date-time</code></li>
<li><code>time</code></li>
<li><code>date</code></li>
<li><code>duration</code></li>
<li><code>email</code></li>
<li><code>hostname</code></li>
<li><code>ipv4</code></li>
<li><code>ipv6</code></li>
<li><code>uuid</code></li>
</ul>
</li>
</ul>
<h5 id="number"><a href="#number" class="headerlink" title="number"></a>number</h5><ul>
<li><code>multipleOf</code>ï¼šå¿…é¡»æ˜¯è¯¥æ•°çš„å€æ•°</li>
<li><code>maximum</code>ï¼š&lt;&#x3D;</li>
<li><code>exclusiveMaximum</code>ï¼š&lt;</li>
<li><code>minimum</code>ï¼š&gt;&#x3D;</li>
<li><code>exclusiveMinimum</code>ï¼š&gt;</li>
</ul>
<h5 id="array"><a href="#array" class="headerlink" title="array"></a>array</h5><ul>
<li><code>minItems</code></li>
<li><code>maxItems</code></li>
</ul>
<h3 id="Json-æ¨¡å¼"><a href="#Json-æ¨¡å¼" class="headerlink" title="Json æ¨¡å¼"></a>Json æ¨¡å¼</h3><p>å°†<code>text.format</code>è®¾ç½®ä¸ºï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;json_object&quot;</span> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨å‡½æ•°è°ƒç”¨æ—¶ï¼ŒJSON æ¨¡å¼å°†å§‹ç»ˆå¼€å¯ã€‚</p>
<p>ä½¿ç”¨ JSON æ¨¡å¼æ—¶ï¼Œå¿…é¡»å§‹ç»ˆé€šè¿‡å¯¹è¯ä¸­çš„æŸäº›æ¶ˆæ¯ï¼ˆä¾‹å¦‚é€šè¿‡ç³»ç»Ÿæ¶ˆæ¯ï¼‰æŒ‡ç¤ºæ¨¡å‹ç”Ÿæˆ JSONï¼Œå¦åˆ™å¯èƒ½ä¼šç”Ÿæˆæ— ä¼‘æ­¢çš„ç©ºç™½å­—ç¬¦æµã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">response = client.responses.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-3.5-turbo-0125&quot;</span>,</span><br><span class="line">        <span class="built_in">input</span>=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a helpful assistant designed to output JSON.&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;Who won the world series in 2020? Please respond in the format &#123;winner: ...&#125;&quot;</span>&#125;</span><br><span class="line">        ],</span><br><span class="line">        text=&#123;<span class="string">&quot;format&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;json_object&quot;</span>&#125;&#125;</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨-Tools"><a href="#ä½¿ç”¨-Tools" class="headerlink" title="ä½¿ç”¨ Tools"></a>ä½¿ç”¨ Tools</h2><p>åœ¨ç”Ÿæˆæ¨¡å‹å›å¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å†…ç½®çš„ Tools æ¥æ‰©å±•æ¨¡å‹çš„èƒ½åŠ›ï¼Œå¸®åŠ©æ¨¡å‹ä»ç½‘ç»œæˆ–æ–‡ä»¶ä¸­è·å–æ›´å¤šä¸Šä¸‹æ–‡å’Œä¿¡æ¯ã€‚</p>
<p>ä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line">client = OpenAI()</span><br><span class="line"></span><br><span class="line">response = client.responses.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-4.1&quot;</span>,</span><br><span class="line">    tools=[&#123;<span class="string">&quot;type&quot;</span>: <span class="string">&quot;web_search_preview&quot;</span>&#125;],</span><br><span class="line">    <span class="built_in">input</span>=<span class="string">&quot;What was a positive news story from today?&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(response.output_text)</span><br></pre></td></tr></table></figure>

<h3 id="å¯ç”¨çš„-Tools"><a href="#å¯ç”¨çš„-Tools" class="headerlink" title="å¯ç”¨çš„ Tools"></a>å¯ç”¨çš„ Tools</h3><ul>
<li>å‡½æ•°è°ƒç”¨</li>
<li>ç½‘ç»œæœç´¢</li>
<li>è¿œç¨‹ MCP(Model Context Protocol) æœåŠ¡</li>
<li>æ–‡ä»¶æœç´¢</li>
<li>å›¾ç‰‡ç”Ÿæˆ</li>
<li>ä»£ç è§£é‡Š</li>
<li>è®¡ç®—æœºä½¿ç”¨ï¼šåœ¨è®¡ç®—æœºä¸Šè¿›è¡Œå„ç§æ“ä½œå’Œä»»åŠ¡</li>
</ul>
<h2 id="å‡½æ•°è°ƒç”¨"><a href="#å‡½æ•°è°ƒç”¨" class="headerlink" title="å‡½æ•°è°ƒç”¨"></a>å‡½æ•°è°ƒç”¨</h2><h3 id="å‡½æ•°å®šä¹‰"><a href="#å‡½æ•°å®šä¹‰" class="headerlink" title="å‡½æ•°å®šä¹‰"></a>å‡½æ•°å®šä¹‰</h3><p>å‡½æ•°å¯ä»¥åœ¨æ¯ä¸ª API è¯·æ±‚çš„<code>tools</code>å‚æ•°ä¸­è®¾ç½®ã€‚</p>
<table>
<thead>
<tr>
<th align="left">å­—æ®µ</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>type</code></td>
<td align="left">å¿…é¡»ä¸º <code>function</code></td>
</tr>
<tr>
<td align="left"><code>name</code></td>
<td align="left">å‡½æ•°åç§° (e.g. <code>get_weather</code>)</td>
</tr>
<tr>
<td align="left"><code>description</code></td>
<td align="left">ä½•æ—¶ã€å¦‚ä½•ä½¿ç”¨å‡½æ•°çš„ç»†èŠ‚</td>
</tr>
<tr>
<td align="left"><code>parameters</code></td>
<td align="left">å®šä¹‰å‡½æ•°è¾“å…¥å‚æ•°çš„<a target="_blank" rel="noopener" href="https://json-schema.org/">JSON schema</a></td>
</tr>
<tr>
<td align="left"><code>strict</code></td>
<td align="left">æ˜¯å¦å¯¹å‡½æ•°è°ƒç”¨å¼ºåˆ¶æ‰§è¡Œä¸¥æ ¼æ¨¡å¼</td>
</tr>
</tbody></table>
<p>ä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;type&quot;</span>: <span class="string">&quot;function&quot;</span>,</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;get_weather&quot;</span>,</span><br><span class="line">  <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Retrieves current weather for the given location.&quot;</span>,</span><br><span class="line">  <span class="string">&quot;parameters&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">    <span class="string">&quot;properties&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;location&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">        <span class="string">&quot;description&quot;</span>: <span class="string">&quot;City and country e.g. BogotÃ¡, Colombia&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="string">&quot;units&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">        <span class="string">&quot;enum&quot;</span>: [</span><br><span class="line">          <span class="string">&quot;celsius&quot;</span>,</span><br><span class="line">          <span class="string">&quot;fahrenheit&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Units the temperature will be returned in.&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;required&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;location&quot;</span>,</span><br><span class="line">      <span class="string">&quot;units&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;additionalProperties&quot;</span>: false</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;strict&quot;</span>: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æµå¼å“åº”"><a href="#æµå¼å“åº”" class="headerlink" title="æµå¼å“åº”"></a>æµå¼å“åº”</h2><p>æµå¼å“åº”å…è®¸åœ¨æ¨¡å‹ç»§ç»­ç”Ÿæˆå®Œæ•´å“åº”çš„åŒæ—¶ï¼Œå¼€å§‹æ‰“å°æˆ–å¤„ç†æ¨¡å‹è¾“å‡ºçš„å¼€å¤´éƒ¨åˆ†ã€‚</p>
<p>è®¾ç½®<code>stream=True</code>å³å¯ä½¿ç”¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> openai <span class="keyword">import</span> OpenAI</span><br><span class="line">client = OpenAI()</span><br><span class="line"></span><br><span class="line">stream = client.responses.create(</span><br><span class="line">    model=<span class="string">&quot;gpt-4.1&quot;</span>,</span><br><span class="line">    <span class="built_in">input</span>=[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>: <span class="string">&quot;Say &#x27;double bubble bath&#x27; ten times fast.&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">    ],</span><br><span class="line">    stream=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> event <span class="keyword">in</span> stream:</span><br><span class="line">    <span class="built_in">print</span>(event)</span><br></pre></td></tr></table></figure>

<p>Responses API ä½¿ç”¨è¯­ä¹‰äº‹ä»¶è¿›è¡Œæµå¼ä¼ è¾“ï¼Œæ¯ä¸ªäº‹ä»¶éƒ½æŒ‰ç…§é¢„å®šä¹‰çš„æ¨¡å¼è¿›è¡Œç±»å‹æ ‡æ³¨ã€‚å®Œæ•´çš„äº‹ä»¶ç±»å‹åˆ—è¡¨ï¼Œè¯·å‚é˜…<a target="_blank" rel="noopener" href="https://platform.openai.com/docs/api-reference/responses-streaming">æµå¼ä¼ è¾“çš„ API å‚è€ƒæ–‡æ¡£</a>ã€‚</p>
<h1 id="Agent-Agno"><a href="#Agent-Agno" class="headerlink" title="Agent - Agno"></a>Agent - Agno</h1><h2 id="Agent-åˆ›å»º"><a href="#Agent-åˆ›å»º" class="headerlink" title="Agent åˆ›å»º"></a>Agent åˆ›å»º</h2><p>ç®€å•Agentï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent</span><br><span class="line"><span class="keyword">from</span> agno.models.anthropic <span class="keyword">import</span> Claude</span><br><span class="line"><span class="keyword">from</span> agno.tools.yfinance <span class="keyword">import</span> YFinanceTools</span><br><span class="line"></span><br><span class="line">agent = Agent(</span><br><span class="line">    model=Claude(<span class="built_in">id</span>=<span class="string">&quot;claude-sonnet-4-20250514&quot;</span>),</span><br><span class="line">    tools=[YFinanceTools(stock_price=<span class="literal">True</span>)],</span><br><span class="line">    instructions=<span class="string">&quot;Use tables to display data. Don&#x27;t include any other text.&quot;</span>,</span><br><span class="line">    markdown=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line">agent.print_response(<span class="string">&quot;What is the stock price of Apple?&quot;</span>, stream=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h3 id="OpenAI-Like-æ¨¡å‹"><a href="#OpenAI-Like-æ¨¡å‹" class="headerlink" title="OpenAI Like æ¨¡å‹"></a>OpenAI Like æ¨¡å‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> getenv</span><br><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent, RunResponse</span><br><span class="line"><span class="keyword">from</span> agno.models.openai.like <span class="keyword">import</span> OpenAILike</span><br><span class="line"></span><br><span class="line">agent = Agent(</span><br><span class="line">    model=OpenAILike(</span><br><span class="line">        <span class="built_in">id</span>=<span class="string">&quot;mistralai/Mixtral-8x7B-Instruct-v0.1&quot;</span>,</span><br><span class="line">        api_key=getenv(<span class="string">&quot;TOGETHER_API_KEY&quot;</span>),</span><br><span class="line">        base_url=<span class="string">&quot;https://api.together.xyz/v1&quot;</span>,</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print the response in the terminal</span></span><br><span class="line">agent.print_response(<span class="string">&quot;Share a 2 sentence horror story.&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="è¿è¡Œ-Agent"><a href="#è¿è¡Œ-Agent" class="headerlink" title="è¿è¡Œ Agent"></a>è¿è¡Œ Agent</h3><p>ä» <code>agno 1.6.0</code> å¼€å§‹ï¼Œ<code>run()</code>å°†è¿”å› <code>RunResponseEvent</code> çš„è¿­ä»£å¯¹è±¡ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Iterator</span><br><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent, RunResponseEvent</span><br><span class="line"><span class="keyword">from</span> agno.models.openai <span class="keyword">import</span> OpenAIChat</span><br><span class="line"><span class="keyword">from</span> agno.utils.pprint <span class="keyword">import</span> pprint_run_response</span><br><span class="line"></span><br><span class="line">agent = Agent(model=OpenAIChat(<span class="built_in">id</span>=<span class="string">&quot;gpt-4-mini&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Run agent and return the response as a stream</span></span><br><span class="line">response_stream: Iterator[RunResponseEvent] = agent.run(</span><br><span class="line">    <span class="string">&quot;Tell me a 5 second short story about a lion&quot;</span>,</span><br><span class="line">    stream=<span class="literal">True</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print the response stream in markdown format</span></span><br><span class="line">pprint_run_response(response_stream, markdown=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>



<h2 id="Agent-State"><a href="#Agent-State" class="headerlink" title="Agent State"></a>Agent State</h2><p>Agno æä¾›äº†çŠ¶æ€ç®¡ç†ç³»ç»Ÿï¼Œåªéœ€æ·»åŠ å˜é‡åˆ° <code>session_state</code>ï¼Œä»¥åŠè®¾ç½®<code>add_state_in_messages=True</code>ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent</span><br><span class="line"><span class="keyword">from</span> agno.models.openai <span class="keyword">import</span> OpenAIChat</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define a tool that adds an item to the shopping list</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_item</span>(<span class="params">agent: Agent, item: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Add an item to the shopping list.&quot;&quot;&quot;</span></span><br><span class="line">    agent.session_state[<span class="string">&quot;shopping_list&quot;</span>].append(item)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;The shopping list is now <span class="subst">&#123;agent.session_state[<span class="string">&#x27;shopping_list&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create an Agent that maintains state</span></span><br><span class="line">agent = Agent(</span><br><span class="line">    model=OpenAIChat(<span class="built_in">id</span>=<span class="string">&quot;gpt-4o-mini&quot;</span>),</span><br><span class="line">    <span class="comment"># Initialize the session state with a counter starting at 0</span></span><br><span class="line">    session_state=&#123;<span class="string">&quot;shopping_list&quot;</span>: []&#125;,</span><br><span class="line">    tools=[add_item],</span><br><span class="line">    <span class="comment"># You can use variables from the session state in the instructions</span></span><br><span class="line">    instructions=<span class="string">&quot;Current state (shopping list) is: &#123;shopping_list&#125;&quot;</span>,</span><br><span class="line">    <span class="comment"># Important: Add the state to the messages</span></span><br><span class="line">    add_state_in_messages=<span class="literal">True</span>,</span><br><span class="line">    markdown=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">agent.print_response(<span class="string">&quot;Add milk, eggs, and bread to the shopping list&quot;</span>, stream=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Final session state: <span class="subst">&#123;agent.session_state&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="è·¨å¯¹è¯ä¿æŒçŠ¶æ€"><a href="#è·¨å¯¹è¯ä¿æŒçŠ¶æ€" class="headerlink" title="è·¨å¯¹è¯ä¿æŒçŠ¶æ€"></a>è·¨å¯¹è¯ä¿æŒçŠ¶æ€</h3><p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> textwrap <span class="keyword">import</span> dedent</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent</span><br><span class="line"><span class="keyword">from</span> agno.models.openai <span class="keyword">import</span> OpenAIChat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define tools to manage our shopping list</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_item</span>(<span class="params">agent: Agent, item: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Add an item to the shopping list and return confirmation.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Add the item if it&#x27;s not already in the list</span></span><br><span class="line">    <span class="keyword">if</span> item.lower() <span class="keyword">not</span> <span class="keyword">in</span> [i.lower() <span class="keyword">for</span> i <span class="keyword">in</span> agent.session_state[<span class="string">&quot;shopping_list&quot;</span>]]:</span><br><span class="line">        agent.session_state[<span class="string">&quot;shopping_list&quot;</span>].append(item)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Added &#x27;<span class="subst">&#123;item&#125;</span>&#x27; to the shopping list&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;&#x27;<span class="subst">&#123;item&#125;</span>&#x27; is already in the shopping list&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_item</span>(<span class="params">agent: Agent, item: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Remove an item from the shopping list by name.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Case-insensitive search</span></span><br><span class="line">    <span class="keyword">for</span> i, list_item <span class="keyword">in</span> <span class="built_in">enumerate</span>(agent.session_state[<span class="string">&quot;shopping_list&quot;</span>]):</span><br><span class="line">        <span class="keyword">if</span> list_item.lower() == item.lower():</span><br><span class="line">            agent.session_state[<span class="string">&quot;shopping_list&quot;</span>].pop(i)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">f&quot;Removed &#x27;<span class="subst">&#123;list_item&#125;</span>&#x27; from the shopping list&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;&#x27;<span class="subst">&#123;item&#125;</span>&#x27; was not found in the shopping list&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_items</span>(<span class="params">agent: Agent</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;List all items in the shopping list.&quot;&quot;&quot;</span></span><br><span class="line">    shopping_list = agent.session_state[<span class="string">&quot;shopping_list&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> shopping_list:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;The shopping list is empty.&quot;</span></span><br><span class="line"></span><br><span class="line">    items_text = <span class="string">&quot;\n&quot;</span>.join([<span class="string">f&quot;- <span class="subst">&#123;item&#125;</span>&quot;</span> <span class="keyword">for</span> item <span class="keyword">in</span> shopping_list])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;Current shopping list:\n<span class="subst">&#123;items_text&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a Shopping List Manager Agent that maintains state</span></span><br><span class="line">agent = Agent(</span><br><span class="line">    model=OpenAIChat(<span class="built_in">id</span>=<span class="string">&quot;gpt-4o-mini&quot;</span>),</span><br><span class="line">    <span class="comment"># Initialize the session state with an empty shopping list</span></span><br><span class="line">    session_state=&#123;<span class="string">&quot;shopping_list&quot;</span>: []&#125;,</span><br><span class="line">    tools=[add_item, remove_item, list_items],</span><br><span class="line">    <span class="comment"># You can use variables from the session state in the instructions</span></span><br><span class="line">    instructions=dedent(<span class="string">&quot;&quot;&quot;\</span></span><br><span class="line"><span class="string">        Your job is to manage a shopping list.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        The shopping list starts empty. You can add items, remove items by name, and list all items.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        Current shopping list: &#123;shopping_list&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>),</span><br><span class="line">    show_tool_calls=<span class="literal">True</span>,</span><br><span class="line">    add_state_in_messages=<span class="literal">True</span>,</span><br><span class="line">    markdown=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">agent.print_response(<span class="string">&quot;Add milk, eggs, and bread to the shopping list&quot;</span>, stream=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Session state: <span class="subst">&#123;agent.session_state&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">agent.print_response(<span class="string">&quot;I got bread&quot;</span>, stream=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Session state: <span class="subst">&#123;agent.session_state&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">agent.print_response(<span class="string">&quot;I need apples and oranges&quot;</span>, stream=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Session state: <span class="subst">&#123;agent.session_state&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">agent.print_response(<span class="string">&quot;whats on my list?&quot;</span>, stream=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Session state: <span class="subst">&#123;agent.session_state&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">agent.print_response(<span class="string">&quot;Clear everything from my list and start over with just bananas and yogurt&quot;</span>, stream=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Session state: <span class="subst">&#123;agent.session_state&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="çŠ¶æ€æŒä¹…åŒ–ä¿å­˜"><a href="#çŠ¶æ€æŒä¹…åŒ–ä¿å­˜" class="headerlink" title="çŠ¶æ€æŒä¹…åŒ–ä¿å­˜"></a>çŠ¶æ€æŒä¹…åŒ–ä¿å­˜</h3><p>éœ€è¦è®¾ç½®<code>storage</code>ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;Run `pip install agno openai sqlalchemy` to install dependencies.&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent</span><br><span class="line"><span class="keyword">from</span> agno.models.openai <span class="keyword">import</span> OpenAIChat</span><br><span class="line"><span class="keyword">from</span> agno.storage.sqlite <span class="keyword">import</span> SqliteStorage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Define a tool that adds an item to the shopping list</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_item</span>(<span class="params">agent: Agent, item: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Add an item to the shopping list.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> agent.session_state[<span class="string">&quot;shopping_list&quot;</span>]:</span><br><span class="line">        agent.session_state[<span class="string">&quot;shopping_list&quot;</span>].append(item)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">f&quot;The shopping list is now <span class="subst">&#123;agent.session_state[<span class="string">&#x27;shopping_list&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">agent = Agent(</span><br><span class="line">    model=OpenAIChat(<span class="built_in">id</span>=<span class="string">&quot;gpt-4o-mini&quot;</span>),</span><br><span class="line">    <span class="comment"># Fix the session id to continue the same session across execution cycles</span></span><br><span class="line">    session_id=<span class="string">&quot;fixed_id_for_demo&quot;</span>,</span><br><span class="line">    <span class="comment"># Initialize the session state with an empty shopping list</span></span><br><span class="line">    session_state=&#123;<span class="string">&quot;shopping_list&quot;</span>: []&#125;,</span><br><span class="line">    <span class="comment"># Add a tool that adds an item to the shopping list</span></span><br><span class="line">    tools=[add_item],</span><br><span class="line">    <span class="comment"># Store the session state in a SQLite database</span></span><br><span class="line">    storage=SqliteStorage(table_name=<span class="string">&quot;agent_sessions&quot;</span>, db_file=<span class="string">&quot;tmp/data.db&quot;</span>),</span><br><span class="line">    <span class="comment"># Add the current shopping list from the state in the instructions</span></span><br><span class="line">    instructions=<span class="string">&quot;Current shopping list is: &#123;shopping_list&#125;&quot;</span>,</span><br><span class="line">    <span class="comment"># Important: Set `add_state_in_messages=True`</span></span><br><span class="line">    <span class="comment"># to make `&#123;shopping_list&#125;` available in the instructions</span></span><br><span class="line">    add_state_in_messages=<span class="literal">True</span>,</span><br><span class="line">    markdown=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">agent.print_response(<span class="string">&quot;What&#x27;s on my shopping list?&quot;</span>, stream=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Session state: <span class="subst">&#123;agent.session_state&#125;</span>&quot;</span>)</span><br><span class="line">agent.print_response(<span class="string">&quot;Add milk, eggs, and bread&quot;</span>, stream=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Session state: <span class="subst">&#123;agent.session_state&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h2><p>Agno æä¾›ä¸‰ç§ <code>memory</code>ï¼š</p>
<ol>
<li><code>Session Storage (chat history and session state)</code>ï¼šå°† Agent çš„ä¼šè¯ä»¥åŠ<code>session_state</code>ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå¹¶ä½¿ Agent èƒ½å¤Ÿè¿›è¡Œå¤šè½®å¯¹è¯ã€‚</li>
<li><code>User Memories (user preferences)</code>ï¼šAgent å¯ä»¥å­˜å‚¨å®ƒé€šè¿‡å¯¹è¯äº†è§£åˆ°çš„æœ‰å…³ç”¨æˆ·çš„è§è§£å’Œäº‹å®ã€‚</li>
<li><code>Session Summaries (chat summary)</code>ï¼šAgent å¯ä»¥å­˜å‚¨ä¼šè¯çš„å‹ç¼©è¡¨ç¤ºå½¢å¼ï¼Œåœ¨èŠå¤©å†å²è®°å½•è¿‡é•¿æ—¶éå¸¸æœ‰ç”¨ã€‚</li>
</ol>
<h3 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent</span><br><span class="line"><span class="keyword">from</span> agno.memory.v2.db.sqlite <span class="keyword">import</span> SqliteMemoryDb</span><br><span class="line"><span class="keyword">from</span> agno.memory.v2.memory <span class="keyword">import</span> Memory</span><br><span class="line"><span class="keyword">from</span> agno.models.openai <span class="keyword">import</span> OpenAIChat</span><br><span class="line"><span class="keyword">from</span> agno.storage.sqlite <span class="keyword">import</span> SqliteStorage</span><br><span class="line"><span class="keyword">from</span> rich.pretty <span class="keyword">import</span> pprint</span><br><span class="line"></span><br><span class="line"><span class="comment"># UserId for the memories</span></span><br><span class="line">user_id = <span class="string">&quot;ava&quot;</span></span><br><span class="line"><span class="comment"># Database file for memory and storage</span></span><br><span class="line">db_file = <span class="string">&quot;tmp/agent.db&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize memory.v2</span></span><br><span class="line">memory = Memory(</span><br><span class="line">    <span class="comment"># Use any model for creating memories</span></span><br><span class="line">    model=OpenAIChat(<span class="built_in">id</span>=<span class="string">&quot;gpt-4.1&quot;</span>),</span><br><span class="line">    db=SqliteMemoryDb(table_name=<span class="string">&quot;user_memories&quot;</span>, db_file=db_file),</span><br><span class="line">)</span><br><span class="line"><span class="comment"># Initialize storage</span></span><br><span class="line">storage = SqliteStorage(table_name=<span class="string">&quot;agent_sessions&quot;</span>, db_file=db_file)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize Agent</span></span><br><span class="line">memory_agent = Agent(</span><br><span class="line">    model=OpenAIChat(<span class="built_in">id</span>=<span class="string">&quot;gpt-4.1&quot;</span>),</span><br><span class="line">    <span class="comment"># Store memories in a database</span></span><br><span class="line">    memory=memory,</span><br><span class="line">    <span class="comment"># Give the Agent the ability to update memories</span></span><br><span class="line">    enable_agentic_memory=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># OR - Run the MemoryManager after each response</span></span><br><span class="line">    enable_user_memories=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># Store the chat history in the database</span></span><br><span class="line">    storage=storage,</span><br><span class="line">    <span class="comment"># Add the chat history to the messages</span></span><br><span class="line">    add_history_to_messages=<span class="literal">True</span>,</span><br><span class="line">    <span class="comment"># Number of history runs</span></span><br><span class="line">    num_history_runs=<span class="number">3</span>,</span><br><span class="line">    markdown=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">memory.clear()</span><br><span class="line">memory_agent.print_response(</span><br><span class="line">    <span class="string">&quot;My name is Ava and I like to ski.&quot;</span>,</span><br><span class="line">    user_id=user_id,</span><br><span class="line">    stream=<span class="literal">True</span>,</span><br><span class="line">    stream_intermediate_steps=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Memories about Ava:&quot;</span>)</span><br><span class="line">pprint(memory.get_user_memories(user_id=user_id))</span><br><span class="line"></span><br><span class="line">memory_agent.print_response(</span><br><span class="line">    <span class="string">&quot;I live in san francisco, where should i move within a 4 hour drive?&quot;</span>,</span><br><span class="line">    user_id=user_id,</span><br><span class="line">    stream=<span class="literal">True</span>,</span><br><span class="line">    stream_intermediate_steps=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Memories about Ava:&quot;</span>)</span><br><span class="line">pprint(memory.get_user_memories(user_id=user_id))</span><br></pre></td></tr></table></figure>

<h3 id="ä¼šè¯æ€»ç»“"><a href="#ä¼šè¯æ€»ç»“" class="headerlink" title="ä¼šè¯æ€»ç»“"></a>ä¼šè¯æ€»ç»“</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent</span><br><span class="line">    <span class="keyword">from</span> agno.memory.v2.db.sqlite <span class="keyword">import</span> SqliteMemoryDb</span><br><span class="line">    <span class="keyword">from</span> agno.memory.v2.memory <span class="keyword">import</span> Memory</span><br><span class="line">    <span class="keyword">from</span> agno.models.google.gemini <span class="keyword">import</span> Gemini</span><br><span class="line"></span><br><span class="line">    memory_db = SqliteMemoryDb(table_name=<span class="string">&quot;memory&quot;</span>, db_file=<span class="string">&quot;tmp/memory.db&quot;</span>)</span><br><span class="line">    memory = Memory(db=memory_db)</span><br><span class="line"></span><br><span class="line">    user_id = <span class="string">&quot;jon_hamm@example.com&quot;</span></span><br><span class="line">    session_id = <span class="string">&quot;1001&quot;</span></span><br><span class="line"></span><br><span class="line">    agent = Agent(</span><br><span class="line">        model=Gemini(<span class="built_in">id</span>=<span class="string">&quot;gemini-2.0-flash-exp&quot;</span>),</span><br><span class="line">        memory=memory,</span><br><span class="line">        enable_session_summaries=<span class="literal">True</span>,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    agent.print_response(</span><br><span class="line">        <span class="string">&quot;What can you tell me about quantum computing?&quot;</span>,</span><br><span class="line">        stream=<span class="literal">True</span>,</span><br><span class="line">        user_id=user_id,</span><br><span class="line">        session_id=session_id,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    agent.print_response(</span><br><span class="line">        <span class="string">&quot;I would also like to know about LLMs?&quot;</span>,</span><br><span class="line">        stream=<span class="literal">True</span>,</span><br><span class="line">        user_id=user_id,</span><br><span class="line">        session_id=session_id</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    session_summary = memory.get_session_summary(</span><br><span class="line">        user_id=user_id, session_id=session_id</span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Session summary: <span class="subst">&#123;session_summary.summary&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h2><p>ä½¿ç”¨ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent</span><br><span class="line"></span><br><span class="line">agent = Agent(</span><br><span class="line">    <span class="comment"># Add functions or Toolkits</span></span><br><span class="line">    tools=[...],</span><br><span class="line">    <span class="comment"># Show tool calls in the Agent response</span></span><br><span class="line">    show_tool_calls=<span class="literal">True</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨å·²æœ‰-toolkit"><a href="#ä½¿ç”¨å·²æœ‰-toolkit" class="headerlink" title="ä½¿ç”¨å·²æœ‰ toolkit"></a>ä½¿ç”¨å·²æœ‰ toolkit</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent</span><br><span class="line"><span class="keyword">from</span> agno.tools.duckduckgo <span class="keyword">import</span> DuckDuckGoTools</span><br><span class="line"></span><br><span class="line">agent = Agent(tools=[DuckDuckGoTools()], show_tool_calls=<span class="literal">True</span>, markdown=<span class="literal">True</span>)</span><br><span class="line">agent.print_response(<span class="string">&quot;Whats happening in France?&quot;</span>, stream=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰-Tools"><a href="#è‡ªå®šä¹‰-Tools" class="headerlink" title="è‡ªå®šä¹‰ Tools"></a>è‡ªå®šä¹‰ Tools</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> httpx</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_top_hackernews_stories</span>(<span class="params">num_stories: <span class="built_in">int</span> = <span class="number">10</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Use this function to get top stories from Hacker News.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        num_stories (int): Number of stories to return. Defaults to 10.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        str: JSON string of top stories.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Fetch top story IDs</span></span><br><span class="line">    response = httpx.get(<span class="string">&#x27;https://hacker-news.firebaseio.com/v0/topstories.json&#x27;</span>)</span><br><span class="line">    story_ids = response.json()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Fetch story details</span></span><br><span class="line">    stories = []</span><br><span class="line">    <span class="keyword">for</span> story_id <span class="keyword">in</span> story_ids[:num_stories]:</span><br><span class="line">        story_response = httpx.get(<span class="string">f&#x27;https://hacker-news.firebaseio.com/v0/item/<span class="subst">&#123;story_id&#125;</span>.json&#x27;</span>)</span><br><span class="line">        story = story_response.json()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;text&quot;</span> <span class="keyword">in</span> story:</span><br><span class="line">            story.pop(<span class="string">&quot;text&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">        stories.append(story)</span><br><span class="line">    <span class="keyword">return</span> json.dumps(stories)</span><br><span class="line"></span><br><span class="line">agent = Agent(tools=[get_top_hackernews_stories], show_tool_calls=<span class="literal">True</span>, markdown=<span class="literal">True</span>)</span><br><span class="line">agent.print_response(<span class="string">&quot;Summarize the top 5 stories on hackernews?&quot;</span>, stream=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h2 id="ç»“æ„åŒ–è¾“å‡º-1"><a href="#ç»“æ„åŒ–è¾“å‡º-1" class="headerlink" title="ç»“æ„åŒ–è¾“å‡º"></a>ç»“æ„åŒ–è¾“å‡º</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span></span><br><span class="line"><span class="keyword">from</span> rich.pretty <span class="keyword">import</span> pprint</span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel, Field</span><br><span class="line"><span class="keyword">from</span> agno.agent <span class="keyword">import</span> Agent, RunResponse</span><br><span class="line"><span class="keyword">from</span> agno.models.openai <span class="keyword">import</span> OpenAIChat</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MovieScript</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    setting: <span class="built_in">str</span> = Field(..., description=<span class="string">&quot;Provide a nice setting for a blockbuster movie.&quot;</span>)</span><br><span class="line">    ending: <span class="built_in">str</span> = Field(..., description=<span class="string">&quot;Ending of the movie. If not available, provide a happy ending.&quot;</span>)</span><br><span class="line">    genre: <span class="built_in">str</span> = Field(</span><br><span class="line">        ..., description=<span class="string">&quot;Genre of the movie. If not available, select action, thriller or romantic comedy.&quot;</span></span><br><span class="line">    )</span><br><span class="line">    name: <span class="built_in">str</span> = Field(..., description=<span class="string">&quot;Give a name to this movie&quot;</span>)</span><br><span class="line">    characters: <span class="type">List</span>[<span class="built_in">str</span>] = Field(..., description=<span class="string">&quot;Name of characters for this movie.&quot;</span>)</span><br><span class="line">    storyline: <span class="built_in">str</span> = Field(..., description=<span class="string">&quot;3 sentence storyline for the movie. Make it exciting!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Agent that uses JSON mode</span></span><br><span class="line">json_mode_agent = Agent(</span><br><span class="line">    model=OpenAIChat(<span class="built_in">id</span>=<span class="string">&quot;gpt-4o&quot;</span>),</span><br><span class="line">    description=<span class="string">&quot;You write movie scripts.&quot;</span>,</span><br><span class="line">    response_model=MovieScript,</span><br><span class="line">    use_json_mode=<span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line">json_mode_agent.print_response(<span class="string">&quot;New York&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Agent that uses structured outputs</span></span><br><span class="line">structured_output_agent = Agent(</span><br><span class="line">    model=OpenAIChat(<span class="built_in">id</span>=<span class="string">&quot;gpt-4o&quot;</span>),</span><br><span class="line">    description=<span class="string">&quot;You write movie scripts.&quot;</span>,</span><br><span class="line">    response_model=MovieScript,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">structured_output_agent.print_response(<span class="string">&quot;New York&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="FastAPI"><a href="#FastAPI" class="headerlink" title="FastAPI"></a>FastAPI</h1><p><em>FastAPI æ˜¯ä¸€ä¸ªç”¨äºæ„å»º API çš„ç°ä»£ã€å¿«é€Ÿï¼ˆé«˜æ€§èƒ½ï¼‰çš„ web æ¡†æ¶ï¼Œä¸“ä¸ºåœ¨ Python ä¸­æ„å»º RESTful API è€Œè®¾è®¡ã€‚</em></p>
<h2 id="FastAPI-åŸºæœ¬è·¯ç”±"><a href="#FastAPI-åŸºæœ¬è·¯ç”±" class="headerlink" title="FastAPI åŸºæœ¬è·¯ç”±"></a>FastAPI åŸºæœ¬è·¯ç”±</h2><p>æ¯ä¸ªè·¯ç”±éƒ½æ˜ å°„åˆ°åº”ç”¨ç¨‹åºä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¤„ç†ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œå¹¶è¿”å›ç›¸åº”çš„å“åº”ã€‚</p>
<h3 id="æ ¹è·¯å¾„è·¯ç”±"><a href="#æ ¹è·¯å¾„è·¯ç”±" class="headerlink" title="æ ¹è·¯å¾„è·¯ç”±"></a>æ ¹è·¯å¾„è·¯ç”±</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_root</span>():</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;Hello&quot;</span>: <span class="string">&quot;World&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>@app.get(&quot;/&quot;)</code>ï¼šä½¿ç”¨ <code>@app.get</code> è£…é¥°å™¨åˆ›å»ºä¸€ä¸ªå¤„ç†æ ¹è·¯å¾„çš„è·¯ç”±ã€‚</li>
</ul>
<h3 id="è·¯å¾„å‚æ•°"><a href="#è·¯å¾„å‚æ•°" class="headerlink" title="è·¯å¾„å‚æ•°"></a>è·¯å¾„å‚æ•°</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&#123;item_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_item</span>(<span class="params">item_id: <span class="built_in">int</span>, q: <span class="built_in">str</span> = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;item_id&quot;</span>: item_id, <span class="string">&quot;q&quot;</span>: q&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å…¶ä¸­ <code>&#123;item_id&#125;</code> æ˜¯è·¯å¾„å‚æ•°ï¼Œå¯¹åº”å‡½æ•°å‚æ•° <code>item_id</code>ã€‚</li>
<li><code>q</code>æ˜¯æŸ¥è¯¢å‚æ•°</li>
</ul>
<p>ä½¿ç”¨æµè§ˆå™¨è®¿é—® <strong><a target="_blank" rel="noopener" href="http://127.0.0.1:8000/items/5?q=runoob">http://127.0.0.1:8000/items/5?q=runoob</a></strong>ï¼Œå°†ä¼šçœ‹åˆ°å¦‚ä¸‹ JSON å“åº”ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;item_id&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span> <span class="attr">&quot;q&quot;</span><span class="punctuation">:</span> <span class="string">&quot;runoob&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="è¯·æ±‚ä½“"><a href="#è¯·æ±‚ä½“" class="headerlink" title="è¯·æ±‚ä½“"></a>è¯·æ±‚ä½“</h3><p>æ­¤å¤„ä½¿ç”¨ Pydantic æ¨¡å‹ Item å®šä¹‰äº†ä¸€ä¸ªè¯·æ±‚ä½“ï¼Œæ›´å¤š Pydantic ä»‹ç»å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.runoob.com/fastapi/fastapi-pydantic.html">FastAPI Pydantic æ¨¡å‹</a>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel</span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Item</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    name: <span class="built_in">str</span></span><br><span class="line">    description: <span class="built_in">str</span> = <span class="literal">None</span></span><br><span class="line">    price: <span class="built_in">float</span></span><br><span class="line">    tax: <span class="built_in">float</span> = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/items/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_item</span>(<span class="params">item: Item</span>):</span><br><span class="line">    <span class="keyword">return</span> item</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆè¿”å›ä¸€ä¸ª Pydantic æ¨¡å‹å®ä¾‹ï¼ŒFastAPI å°†è‡ªåŠ¨å°†å…¶è½¬æ¢ä¸º JSON æ ¼å¼ï¼Œå¹¶ä½œä¸ºå“åº”å‘é€ç»™å®¢æˆ·ç«¯ã€‚</p>
<h3 id="è¯·æ±‚å¤´å’Œ-Cookie"><a href="#è¯·æ±‚å¤´å’Œ-Cookie" class="headerlink" title="è¯·æ±‚å¤´å’Œ Cookie"></a>è¯·æ±‚å¤´å’Œ Cookie</h3><p>ä½¿ç”¨ Header å’Œ Cookie ç±»å‹æ³¨è§£è·å–è¯·æ±‚å¤´å’Œ Cookie æ•°æ®ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> Header, Cookie</span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_item</span>(<span class="params">user_agent: <span class="built_in">str</span> = Header(<span class="params"><span class="literal">None</span></span>), session_token: <span class="built_in">str</span> = Cookie(<span class="params"><span class="literal">None</span></span>)</span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;User-Agent&quot;</span>: user_agent, <span class="string">&quot;Session-Token&quot;</span>: session_token&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="headerlink" title="é‡å®šå‘"></a>é‡å®šå‘</h3><p>ä½¿ç”¨ <strong>RedirectResponse</strong> å®ç°é‡å®šå‘ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi.responses <span class="keyword">import</span> RedirectResponse</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/redirect&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">redirect</span>():</span><br><span class="line">    <span class="keyword">return</span> RedirectResponse(url=<span class="string">&quot;/items/&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="é”™è¯¯ç "><a href="#é”™è¯¯ç " class="headerlink" title="é”™è¯¯ç "></a>é”™è¯¯ç </h3><p>ä½¿ç”¨ HTTPException æŠ›å‡ºå¼‚å¸¸ï¼Œè¿”å›è‡ªå®šä¹‰çš„çŠ¶æ€ç å’Œè¯¦ç»†ä¿¡æ¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> HTTPException</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&#123;item_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_item</span>(<span class="params">item_id: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="keyword">if</span> item_id == <span class="number">42</span>:</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">404</span>, detail=<span class="string">&quot;Item not found&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;item_id&quot;</span>: item_id&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰å“åº”å¤´"><a href="#è‡ªå®šä¹‰å“åº”å¤´" class="headerlink" title="è‡ªå®šä¹‰å“åº”å¤´"></a>è‡ªå®šä¹‰å“åº”å¤´</h3><p>ä½¿ç”¨ <strong>JSONResponse</strong> è‡ªå®šä¹‰å“åº”å¤´</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI</span><br><span class="line"><span class="keyword">from</span> fastapi.responses <span class="keyword">import</span> JSONResponse</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&#123;item_id&#125;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_item</span>(<span class="params">item_id: <span class="built_in">int</span></span>):</span><br><span class="line">    content = &#123;<span class="string">&quot;item_id&quot;</span>: item_id&#125;</span><br><span class="line">    headers = &#123;<span class="string">&quot;X-Custom-Header&quot;</span>: <span class="string">&quot;custom-header-value&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">return</span> JSONResponse(content=content, headers=headers)</span><br></pre></td></tr></table></figure>

<h3 id="è·¯å¾„æ“ä½œä¾èµ–é¡¹"><a href="#è·¯å¾„æ“ä½œä¾èµ–é¡¹" class="headerlink" title="è·¯å¾„æ“ä½œä¾èµ–é¡¹"></a>è·¯å¾„æ“ä½œä¾èµ–é¡¹</h3><p>ä¾èµ–é¡¹æ˜¯åœ¨è·¯ç”±æ“ä½œå‡½æ•°æ‰§è¡Œå‰æˆ–åè¿è¡Œçš„å¯å¤ç”¨çš„å‡½æ•°æˆ–å¯¹è±¡ã€‚åœ¨ FastAPI ä¸­ï¼Œä¾èµ–é¡¹é€šå¸¸ç”¨äºä¸¤ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>é¢„å¤„ç†ï¼ˆBeforeï¼‰ä¾èµ–é¡¹ï¼š</strong> åœ¨è·¯ç”±æ“ä½œå‡½æ•°æ‰§è¡Œå‰è¿è¡Œï¼Œç”¨äºé¢„å¤„ç†è¾“å…¥æ•°æ®ï¼ŒéªŒè¯è¯·æ±‚ç­‰ã€‚</li>
<li><strong>åå¤„ç†ï¼ˆAfterï¼‰ä¾èµ–é¡¹ï¼š</strong> åœ¨è·¯ç”±æ“ä½œå‡½æ•°æ‰§è¡Œåè¿è¡Œï¼Œç”¨äºæ‰§è¡Œä¸€äº›åå¤„ç†é€»è¾‘ï¼Œå¦‚æ—¥å¿—è®°å½•ã€æ¸…ç†ç­‰ã€‚</li>
</ul>
<h4 id="é¢„å¤„ç†"><a href="#é¢„å¤„ç†" class="headerlink" title="é¢„å¤„ç†"></a>é¢„å¤„ç†</h4><p>åœ¨è·¯ç”±æ“ä½œå‡½æ•° <strong>read_items</strong> ä¸­ï¼Œé€šè¿‡ä¼ å…¥ Depends(common_parameters)ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†è¿™ä¸ªä¾èµ–é¡¹å‡½æ•°ï¼Œå®ç°äº†åœ¨è·¯ç”±æ‰§è¡Œå‰é¢„å¤„ç†è¾“å…¥æ•°æ®çš„åŠŸèƒ½ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> Depends, FastAPI, HTTPException</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¾èµ–é¡¹å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_parameters</span>(<span class="params">q: <span class="built_in">str</span> = <span class="literal">None</span>, skip: <span class="built_in">int</span> = <span class="number">0</span>, limit: <span class="built_in">int</span> = <span class="number">100</span></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;q&quot;</span>: q, <span class="string">&quot;skip&quot;</span>: skip, <span class="string">&quot;limit&quot;</span>: limit&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·¯ç”±æ“ä½œå‡½æ•°</span></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">read_items</span>(<span class="params">commons: <span class="built_in">dict</span> = Depends(<span class="params">common_parameters</span>)</span>):</span><br><span class="line">    <span class="keyword">return</span> commons</span><br></pre></td></tr></table></figure>

<h4 id="åå¤„ç†"><a href="#åå¤„ç†" class="headerlink" title="åå¤„ç†"></a>åå¤„ç†</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> Depends, FastAPI, HTTPException</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¾èµ–é¡¹å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_parameters</span>(<span class="params">q: <span class="built_in">str</span> = <span class="literal">None</span>, skip: <span class="built_in">int</span> = <span class="number">0</span>, limit: <span class="built_in">int</span> = <span class="number">100</span></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;q&quot;</span>: q, <span class="string">&quot;skip&quot;</span>: skip, <span class="string">&quot;limit&quot;</span>: limit&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·¯ç”±æ“ä½œå‡½æ•°</span></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">read_items</span>(<span class="params">commons: <span class="built_in">dict</span> = Depends(<span class="params">common_parameters</span>)</span>):</span><br><span class="line">    <span class="keyword">return</span> commons</span><br><span class="line"></span><br><span class="line"><span class="comment"># åå¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">after_request</span>():</span><br><span class="line">    <span class="comment"># è¿™é‡Œå¯ä»¥æ‰§è¡Œä¸€äº›åå¤„ç†é€»è¾‘ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åå¤„ç†ä¾èµ–é¡¹</span></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&quot;</span>, response_model=<span class="built_in">dict</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">read_items_after</span>(<span class="params">request: <span class="built_in">dict</span> = Depends(<span class="params">after_request</span>)</span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Items returned successfully&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å¤šä¸ªä¾èµ–é¡¹ç»„åˆ"><a href="#å¤šä¸ªä¾èµ–é¡¹ç»„åˆ" class="headerlink" title="å¤šä¸ªä¾èµ–é¡¹ç»„åˆ"></a>å¤šä¸ªä¾èµ–é¡¹ç»„åˆ</h4><p>ä»¥ä¸‹ä¾‹å­ä¸­ï¼Œ<strong>common_parameters</strong> å’Œ <strong>verify_token</strong> æ˜¯ä¸¤ä¸ªä¸åŒçš„ä¾èµ–é¡¹å‡½æ•°ï¼Œ<strong>verify_token</strong> ä¾èµ–äº <strong>common_parameters</strong>ï¼Œè¿™ç§ç»„åˆä¾èµ–é¡¹çš„æ–¹å¼å…è®¸æˆ‘ä»¬åœ¨è·¯ç”±æ‰§è¡Œå‰å…ˆéªŒè¯ä¸€äº›å‚æ•°ï¼Œç„¶ååœ¨è¿›è¡Œèº«ä»½éªŒè¯ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> Depends, FastAPI, HTTPException</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¾èµ–é¡¹å‡½æ•°1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_parameters</span>(<span class="params">q: <span class="built_in">str</span> = <span class="literal">None</span>, skip: <span class="built_in">int</span> = <span class="number">0</span>, limit: <span class="built_in">int</span> = <span class="number">100</span></span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;q&quot;</span>: q, <span class="string">&quot;skip&quot;</span>: skip, <span class="string">&quot;limit&quot;</span>: limit&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¾èµ–é¡¹å‡½æ•°2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_token</span>(<span class="params">token: <span class="built_in">str</span> = Depends(<span class="params">common_parameters</span>)</span>):</span><br><span class="line">    <span class="keyword">if</span> token <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">raise</span> HTTPException(status_code=<span class="number">400</span>, detail=<span class="string">&quot;Token required&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> token</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·¯ç”±æ“ä½œå‡½æ•°</span></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/items/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">read_items</span>(<span class="params">token: <span class="built_in">dict</span> = Depends(<span class="params">verify_token</span>)</span>):</span><br><span class="line">    <span class="keyword">return</span> token</span><br></pre></td></tr></table></figure>



<h2 id="FastAPI-äº¤äº’å¼-API-æ–‡æ¡£"><a href="#FastAPI-äº¤äº’å¼-API-æ–‡æ¡£" class="headerlink" title="FastAPI äº¤äº’å¼ API æ–‡æ¡£"></a>FastAPI äº¤äº’å¼ API æ–‡æ¡£</h2><p>FastAPI æä¾›äº†å†…ç½®çš„äº¤äº’å¼ API æ–‡æ¡£ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿè½»æ¾äº†è§£å’Œæµ‹è¯• API çš„å„ä¸ªç«¯ç‚¹ã€‚</p>
<p>è¿™ä¸ªæ–‡æ¡£æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ï¼ŒåŸºäº OpenAPI è§„èŒƒï¼Œæ”¯æŒ Swagger UI å’Œ ReDoc ä¸¤ç§äº¤äº’å¼ç•Œé¢ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡è®¿é—® <strong><a target="_blank" rel="noopener" href="http://127.0.0.1:8000/docs">http://127.0.0.1:8000/docs</a></strong> æ¥æ‰“å¼€ Swagger UI é£æ ¼çš„æ–‡æ¡£ï¼š</p>
<p><img src= "/img/spin.svg" data-lazy-src="https://rean-blog-bucket.oss-cn-guangzhou.aliyuncs.com/assets/essay/20250722163914.png"></p>
<p>æˆ–è€…é€šè¿‡ <strong><a target="_blank" rel="noopener" href="http://127.0.0.1:8000/redoc">http://127.0.0.1:8000/redoc</a></strong> æ¥æ‰“å¼€ ReDoc é£æ ¼çš„æ–‡æ¡£ã€‚</p>
<p><img src= "/img/spin.svg" data-lazy-src="https://rean-blog-bucket.oss-cn-guangzhou.aliyuncs.com/assets/essay/20250722163950.png"></p>
<h1 id="SSE"><a href="#SSE" class="headerlink" title="SSE"></a>SSE</h1><p>æœåŠ¡ç«¯æ¨é€ï¼ˆServer-Send Eventsï¼‰ï¼Œä¹Ÿç§°ä¸ºæ¶ˆæ¯æ¨é€æˆ–é€šçŸ¥æ¨é€ï¼Œæ˜¯ä¸€ç§å…è®¸åº”ç”¨<strong>æœåŠ¡å™¨ä¸»åŠ¨å°†ä¿¡æ¯å‘é€åˆ°å®¢æˆ·ç«¯</strong>çš„èƒ½åŠ›ã€‚</p>
<table>
<thead>
<tr>
<th>æŠ€æœ¯</th>
<th>åè®®</th>
<th>æ–¹å‘æ€§</th>
<th>å¤æ‚åº¦</th>
<th>å»¶è¿Ÿ</th>
<th>é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody><tr>
<td>çŸ­è½®è¯¢</td>
<td>HTTP</td>
<td>åŒå‘ï¼ˆä¼ªï¼‰</td>
<td>ä½</td>
<td>é«˜</td>
<td>ç®€å•çŠ¶æ€æ£€æµ‹</td>
</tr>
<tr>
<td>é•¿è½®è¯¢</td>
<td>HTTP</td>
<td>åŒå‘ï¼ˆä¼ªï¼‰</td>
<td>ä¸­</td>
<td>ä¸­</td>
<td>å³æ—¶æ¶ˆæ¯</td>
</tr>
<tr>
<td>WebSocket</td>
<td>WS</td>
<td>å…¨åŒå·¥</td>
<td>é«˜</td>
<td>ä½</td>
<td>æ¸¸æˆ&#x2F;é«˜é¢‘äº¤æ˜“</td>
</tr>
<tr>
<td>SSE</td>
<td>HTTP</td>
<td>å•å‘ï¼ˆæœåŠ¡ç«¯â†’å®¢æˆ·ç«¯ï¼‰</td>
<td>ä½</td>
<td>ä½</td>
<td>å®æ—¶é€šçŸ¥&#x2F;æ—¥å¿—æµ</td>
</tr>
</tbody></table>
<h2 id="SSEçš„æ ¸å¿ƒä¼˜åŠ¿"><a href="#SSEçš„æ ¸å¿ƒä¼˜åŠ¿" class="headerlink" title="SSEçš„æ ¸å¿ƒä¼˜åŠ¿"></a>SSEçš„æ ¸å¿ƒä¼˜åŠ¿</h2><ul>
<li><strong>åè®®è½»é‡</strong>ï¼šåŸºäºæ ‡å‡†HTTPåè®®ï¼Œæ— éœ€é¢å¤–æ¡æ‰‹</li>
<li><strong>è‡ªåŠ¨é‡è¿</strong>ï¼šå†…ç½®æ–­çº¿é‡è¿æœºåˆ¶ï¼ˆretryå­—æ®µï¼‰</li>
<li><strong>æ–‡æœ¬å‹å¥½</strong>ï¼šå¤©ç„¶æ”¯æŒUTF-8æ–‡æœ¬æ•°æ®æµ</li>
<li><strong>æµè§ˆå™¨åŸç”Ÿæ”¯æŒ</strong>ï¼šç°ä»£æµè§ˆå™¨100%å…¼å®¹ï¼ˆIEé™¤å¤–ï¼‰</li>
</ul>
<h2 id="FastAPI-SSE-ç¤ºä¾‹ä»£ç "><a href="#FastAPI-SSE-ç¤ºä¾‹ä»£ç " class="headerlink" title="FastAPI SSE ç¤ºä¾‹ä»£ç "></a>FastAPI SSE ç¤ºä¾‹ä»£ç </h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Iterable</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Request</span><br><span class="line"><span class="keyword">from</span> sse_starlette.sse <span class="keyword">import</span> EventSourceResponse</span><br><span class="line"><span class="keyword">from</span> starlette.responses <span class="keyword">import</span> FileResponse</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">read_index</span>():</span><br><span class="line">    <span class="keyword">return</span> FileResponse(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line">STREAM_DELAY = <span class="number">1</span>  <span class="comment"># second</span></span><br><span class="line">RETRY_TIMEOUT = <span class="number">15000</span>  <span class="comment"># millisecond</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_new_messages</span>() -&gt; Iterable:</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;event&quot;</span>: <span class="string">&quot;new_message&quot;</span>,</span><br><span class="line">            <span class="string">&quot;retry&quot;</span>: RETRY_TIMEOUT,</span><br><span class="line">            <span class="string">&quot;data&quot;</span>: json.dumps(</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;message&quot;</span>: <span class="string">&quot;test message&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;datetime&quot;</span>: datetime.datetime.now().isoformat(</span><br><span class="line">                        sep=<span class="string">&quot;T&quot;</span>, timespec=<span class="string">&quot;auto&quot;</span></span><br><span class="line">                    ),</span><br><span class="line">                &#125;</span><br><span class="line">            ),</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: uuid.uuid4(),</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">event_generator</span>(<span class="params">request: Request</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">await</span> request.is_disconnected():</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">for</span> message <span class="keyword">in</span> get_new_messages():</span><br><span class="line">            <span class="keyword">yield</span> message</span><br><span class="line">        <span class="keyword">await</span> asyncio.sleep(STREAM_DELAY)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/stream&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">message_stream</span>(<span class="params">request: Request</span>):</span><br><span class="line">    <span class="keyword">return</span> EventSourceResponse(event_generator(request))</span><br></pre></td></tr></table></figure>

<h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><p>Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œå¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ linux æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚</p>
<p>å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨<strong>æ²™ç®±</strong>æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ï¼ˆç±» IPhone çš„ appï¼‰ï¼Œå¹¶ä¸”å®¹å™¨å¼€é”€æå…¶ä½ã€‚</p>
<h2 id="é•œåƒï¼ˆImageï¼‰ä¸å®¹å™¨ï¼ˆContainerï¼‰"><a href="#é•œåƒï¼ˆImageï¼‰ä¸å®¹å™¨ï¼ˆContainerï¼‰" class="headerlink" title="é•œåƒï¼ˆImageï¼‰ä¸å®¹å™¨ï¼ˆContainerï¼‰"></a>é•œåƒï¼ˆImageï¼‰ä¸å®¹å™¨ï¼ˆContainerï¼‰</h2><ul>
<li><strong>é•œåƒï¼ˆImageï¼‰</strong>ï¼šå®¹å™¨çš„é™æ€æ¨¡æ¿ï¼ŒåŒ…å«äº†åº”ç”¨ç¨‹åºè¿è¡Œæ‰€éœ€çš„æ‰€æœ‰ä¾èµ–å’Œæ–‡ä»¶ã€‚é•œåƒæ˜¯ä¸å¯å˜çš„ã€‚</li>
<li><strong>å®¹å™¨ï¼ˆContainerï¼‰</strong>ï¼šé•œåƒçš„ä¸€ä¸ªè¿è¡Œå®ä¾‹ï¼Œå…·æœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹ã€ç½‘ç»œç­‰ï¼Œä¸”æ˜¯åŠ¨æ€çš„ã€‚å®¹å™¨ä»é•œåƒå¯åŠ¨ï¼Œå¹¶åœ¨è¿è¡Œæ—¶ä¿æŒå¯å˜ã€‚</li>
</ul>
<p><img src= "/img/spin.svg" data-lazy-src="https://rean-blog-bucket.oss-cn-guangzhou.aliyuncs.com/assets/essay/20250723160404.png"></p>
<h3 id="é•œåƒä»“åº“ï¼ˆDocker-Registryï¼‰"><a href="#é•œåƒä»“åº“ï¼ˆDocker-Registryï¼‰" class="headerlink" title="é•œåƒä»“åº“ï¼ˆDocker Registryï¼‰"></a>é•œåƒä»“åº“ï¼ˆDocker Registryï¼‰</h3><p>é•œåƒä»“åº“ (Docker Registry) è´Ÿè´£å­˜å‚¨ã€ç®¡ç†å’Œåˆ†å‘é•œåƒï¼Œå¹¶ä¸”æä¾›äº†ç™»å½•è®¤è¯èƒ½åŠ›ï¼Œå»ºç«‹äº†ä»“åº“çš„ç´¢å¼•ã€‚</p>
<p>é•œåƒä»“åº“ç®¡ç†å¤šä¸ª Repositoryï¼Œ Repository é€šè¿‡å‘½åæ¥åŒºåˆ†ã€‚æ¯ä¸ª Repository åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒï¼Œé•œåƒé€šè¿‡é•œåƒåç§°å’Œæ ‡ç­¾æ¥åŒºåˆ†ã€‚</p>
<h3 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h3><p>Dockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«äº†æ„å»º Docker é•œåƒçš„æ‰€æœ‰æŒ‡ä»¤ã€‚</p>
<p>åŸºæœ¬ç»“æ„åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li>åŸºç¡€æ˜ åƒï¼ˆBase Imageï¼‰ï¼šä½¿ç”¨ FROM æŒ‡ä»¤æŒ‡å®šåŸºç¡€æ˜ åƒï¼Œä½œä¸ºæ„å»ºé•œåƒçš„èµ·ç‚¹ã€‚åŸºç¡€æ˜ åƒé€šå¸¸åŒ…å«äº†æ“ä½œç³»ç»Ÿå’Œä¸€äº›é¢„è£…çš„è½¯ä»¶å’Œå·¥å…·ã€‚</li>
<li>æ„å»ºè¿‡ç¨‹æŒ‡ä»¤ï¼šä½¿ç”¨ä¸€ç³»åˆ—æŒ‡ä»¤æ¥æè¿°æ„å»ºè¿‡ç¨‹ï¼Œä¾‹å¦‚ RUN ç”¨äºæ‰§è¡Œå‘½ä»¤å’Œå®‰è£…è½¯ä»¶åŒ…ï¼ŒCOPY ç”¨äºæ‹·è´æ–‡ä»¶å’Œç›®å½•ï¼ŒADD ç”¨äºæ‹·è´å’Œæå–æ–‡ä»¶ï¼ŒWORKDIR ç”¨äºè®¾ç½®å·¥ä½œç›®å½•ï¼Œç­‰ç­‰ã€‚</li>
<li>å®¹å™¨å¯åŠ¨æŒ‡ä»¤ï¼šä½¿ç”¨ CMD æˆ– ENTRYPOINT æŒ‡ä»¤æ¥å®šä¹‰å®¹å™¨å¯åŠ¨æ—¶è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯é»˜è®¤çš„å®¹å™¨æ‰§è¡Œå‘½ä»¤ã€‚</li>
</ul>
<h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight dockerfile"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FROM</span> centos7.<span class="number">9.2009</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> akuya&lt;<span class="number">123456</span>@qq.com&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®ç¯å¢ƒä»¥åŠå·¥ä½œç›®å½•</span></span><br><span class="line"><span class="keyword">ENV</span> MYPATH /usr/local</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> <span class="variable">$MYPATH</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…vimã€ipconfigç­‰å‘½ä»¤</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install vim</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install net-tools</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æš´éœ²ç«¯å£</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$MYPATH</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;---akuya---&quot;</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> /bin/bash</span></span><br></pre></td></tr></table></figure>

<h4 id="æ„å»ºé•œåƒ"><a href="#æ„å»ºé•œåƒ" class="headerlink" title="æ„å»ºé•œåƒ"></a>æ„å»ºé•œåƒ</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ„å»ºé•œåƒå‘½ä»¤</span></span><br><span class="line">docker build -f Dockerfile -t mycentos:1.0 .</span><br></pre></td></tr></table></figure>

<p>å‚æ•°ï¼š</p>
<ul>
<li><code>-f</code>ï¼šç­‰ä»·äº<code>--file</code>ï¼ŒæŒ‡å®š dockerfile æ–‡ä»¶</li>
<li><code>-t</code>ï¼šç­‰ä»·äº<code>--tag</code>ï¼ŒæŒ‡å®šè¾“å‡ºçš„é•œåƒæ–‡ä»¶å:ç‰ˆæœ¬å·</li>
</ul>
<p><strong>å‘½ä»¤æœ€åä¸€å®šè¦åŠ ä¸€ä¸ª<code>.</code></strong></p>
<h2 id="å®¹å™¨-vs-è™šæ‹Ÿæœº"><a href="#å®¹å™¨-vs-è™šæ‹Ÿæœº" class="headerlink" title="å®¹å™¨ vs è™šæ‹Ÿæœº"></a>å®¹å™¨ vs è™šæ‹Ÿæœº</h2><p>å®¹å™¨æ—¶åœ¨ linux ä¸Šæœ¬æœºè¿è¡Œï¼Œå¹¶ä¸å…¶ä»–å®¹å™¨å…±äº«ä¸»æœºçš„å†…æ ¸ï¼Œå®ƒè¿è¡Œçš„æ˜¯ä¸€ä¸ª<strong>ç‹¬ç«‹çš„è¿›ç¨‹</strong>ï¼Œä¸å ç”¨å…¶ä»–ä»»ä½•å¯æ‰§è¡Œæ–‡ä»¶çš„å†…å­˜ï¼Œéå¸¸è½»é‡ã€‚</p>
<p>è™šæ‹Ÿæœºè¿è¡Œçš„æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œé€šè¿‡è™šæ‹Ÿæœºç®¡ç†ç¨‹åºå¯¹ä¸»æœºèµ„æºè¿›è¡Œè™šæ‹Ÿè®¿é—®ï¼Œç›¸æ¯”ä¹‹ä¸‹éœ€è¦çš„èµ„æºæ›´å¤šã€‚</p>
<h2 id="å·ï¼ˆVolumeï¼‰"><a href="#å·ï¼ˆVolumeï¼‰" class="headerlink" title="å·ï¼ˆVolumeï¼‰"></a>å·ï¼ˆVolumeï¼‰</h2><p>å·æ˜¯ç”¨äºæŒä¹…åŒ–æ•°æ®çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥åœ¨å®¹å™¨ä¹‹é—´å…±äº«å’Œé‡ç”¨ã€‚é€šè¿‡ä½¿ç”¨å·ï¼Œæ•°æ®å¯ä»¥åœ¨å®¹å™¨åœæ­¢æˆ–åˆ é™¤æ—¶ä»ç„¶ä¿ç•™ã€‚</p>
<p>ä½¿ç”¨æ•°æ®å·çš„æ­¥éª¤ä¸€èˆ¬åˆ†ä¸ºä¸¤æ­¥ï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªæ•°æ®å·</li>
<li>ä½¿ç”¨ <code>-v</code> æˆ– <code>--mount</code> å‚æ•°å°†æ•°æ®å·æŒ‚è½½å®¹å™¨æŒ‡å®šç›®å½•ä¸­ï¼Œè¿™æ ·æ‰€æœ‰è¯¥å®¹å™¨é’ˆå¯¹è¯¥æŒ‡å®šç›®å½•çš„å†™æ“ä½œéƒ½ä¼šä¿å­˜åœ¨å®¿ä¸»æœºä¸Šçš„ Volume ä¸­ã€‚</li>
</ol>
<h3 id="åˆ›å»º-volume"><a href="#åˆ›å»º-volume" class="headerlink" title="åˆ›å»º volume"></a>åˆ›å»º volume</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker volume create my-vol</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹-volume"><a href="#æŸ¥çœ‹-volume" class="headerlink" title="æŸ¥çœ‹ volume"></a>æŸ¥çœ‹ volume</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker volume <span class="built_in">ls</span></span></span><br><span class="line">local    my-vol</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker volume inspect my-vol</span></span><br><span class="line">[</span><br><span class="line"> &#123;</span><br><span class="line">  &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">  &quot;Labels&quot;: &#123;&#125;,</span><br><span class="line">  &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/my-vol/_data&quot;,</span><br><span class="line">  &quot;Name&quot;: &quot;my-vol&quot;,</span><br><span class="line">  &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">  &quot;Scope&quot;: &quot;local&quot;</span><br><span class="line"> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="åˆ é™¤-volume"><a href="#åˆ é™¤-volume" class="headerlink" title="åˆ é™¤ volume"></a>åˆ é™¤ volume</h3><p>åˆ é™¤ä¸€ä¸ª Volumeï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker volume rm my-vol</span><br></pre></td></tr></table></figure>

<p>åˆ é™¤æ‰€æœ‰æœªä½¿ç”¨çš„ Volumesï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker volume prune</span><br></pre></td></tr></table></figure>

<h3 id="æŒ‚è½½æ•°æ®å·åˆ°å®¹å™¨ç›®å½•"><a href="#æŒ‚è½½æ•°æ®å·åˆ°å®¹å™¨ç›®å½•" class="headerlink" title="æŒ‚è½½æ•°æ®å·åˆ°å®¹å™¨ç›®å½•"></a>æŒ‚è½½æ•°æ®å·åˆ°å®¹å™¨ç›®å½•</h3><p>ä½¿ç”¨<code>--mount</code>å‚æ•°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run -d \</span></span><br><span class="line"><span class="language-bash"> --name=nginxtest \</span></span><br><span class="line"><span class="language-bash"> --mount <span class="built_in">source</span>=nginx-vol,destination=/usr/share/nginx/html \</span></span><br><span class="line"><span class="language-bash"> nginx:latest</span></span><br></pre></td></tr></table></figure>

<p><code>source</code> æŒ‡å®š <code>volume</code>ï¼Œ<code>destination</code> æŒ‡å®šå®¹å™¨å†…çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ã€‚</p>
<p>ä½¿ç”¨ -v å‚æ•°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run -d \</span></span><br><span class="line"><span class="language-bash"> --name=nginxtest \</span></span><br><span class="line"><span class="language-bash"> -v nginx-vol:/usr/share/nginx/html \</span></span><br><span class="line"><span class="language-bash"> nginx:latest</span></span><br></pre></td></tr></table></figure>

<p><code>-v</code> å‚æ•°ä½¿ç”¨å†’å·åˆ†å‰² <code>source</code> å’Œ <code>destination</code>ï¼Œå†’å·å‰åŠéƒ¨åˆ†æ˜¯ <code>source</code>ï¼ŒååŠéƒ¨åˆ†æ˜¯ <code>destination</code>ã€‚</p>
<p>æŒ‚è½½æˆåŠŸåï¼Œå®¹å™¨ä» <strong>&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html</strong> ç›®å½•ä¸‹è¯»å–æˆ–å†™å…¥æ•°æ®ï¼Œå®é™…ä¸Šéƒ½æ˜¯ä»å®¿ä¸»æœºçš„ nginx-vol æ•°æ®å·ä¸­è¯»å–æˆ–å†™å…¥æ•°æ®ã€‚å› æ­¤ Volumes æˆ– Bind mounts ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å®¹å™¨å’Œå®¿ä¸»æœºå…±äº«æ–‡ä»¶çš„ä¸€ç§æ–¹å¼ã€‚</p>
<h2 id="å¯åŠ¨å®¹å™¨"><a href="#å¯åŠ¨å®¹å™¨" class="headerlink" title="å¯åŠ¨å®¹å™¨"></a>å¯åŠ¨å®¹å™¨</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure>

<p>å‚æ•°ï¼š</p>
<ul>
<li><strong><code>-d</code></strong>: åå°è¿è¡Œå®¹å™¨å¹¶è¿”å›å®¹å™¨ IDã€‚</li>
<li><strong><code>-it</code></strong>: äº¤äº’å¼è¿è¡Œå®¹å™¨ï¼Œåˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚</li>
<li><strong><code>--name</code></strong>: ç»™å®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ã€‚<code>docker run --name my_container ubuntu</code>å³è¿è¡Œä¸€ä¸ª ubuntu å®¹å™¨ï¼Œå¹¶å°†å…¶å‘½åä¸º my_containerã€‚</li>
<li><strong><code>-p</code></strong>: ç«¯å£æ˜ å°„ï¼Œæ ¼å¼ä¸º <code>host_port:container_port</code>ã€‚<code>docker run -p 8080:80 nginx</code>å³å°†æœ¬åœ°ä¸»æœºçš„ 8080 ç«¯å£æ˜ å°„åˆ°å®¹å™¨å†…çš„ 80 ç«¯å£ï¼Œè¿è¡Œ nginx å®¹å™¨ã€‚</li>
<li><strong><code>-v</code></strong>: æŒ‚è½½å·ï¼Œæ ¼å¼ä¸º <code>host_dir:container_dir</code>ã€‚</li>
<li><strong><code>--rm</code></strong>: å®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤å®¹å™¨ã€‚</li>
<li><strong><code>--env</code> æˆ– <code>-e</code></strong>: è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</li>
<li><strong><code>--network</code></strong>: æŒ‡å®šå®¹å™¨çš„ç½‘ç»œæ¨¡å¼ã€‚</li>
<li><strong><code>--restart</code></strong>: å®¹å™¨çš„é‡å¯ç­–ç•¥ï¼ˆå¦‚ <code>no</code>ã€<code>on-failure</code>ã€<code>always</code>ã€<code>unless-stopped</code>ï¼‰ã€‚</li>
<li><strong><code>-u</code></strong>: æŒ‡å®šç”¨æˆ·ã€‚</li>
</ul>
<h2 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h2><p>Docker Compose æ˜¯ä¸€ä¸ªç”¨äº<strong>å®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨</strong>çš„å·¥å…·ã€‚é€šè¿‡ä¸€ä¸ª YAML æ–‡ä»¶ï¼ˆ<code>docker-compose.yml</code>ï¼‰å¯ä»¥é…ç½®åº”ç”¨ç¨‹åºçš„æ‰€æœ‰æœåŠ¡ï¼Œç„¶åä½¿ç”¨å•ä¸ªå‘½ä»¤åˆ›å»ºå’Œå¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚</p>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><div class="note  flat warning"><p>åœ¨å®‰è£… Docker Compose å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£… <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/">Docker Engine</a></p>
</div>

<h4 id="Linux-å®‰è£…æ–¹æ³•"><a href="#Linux-å®‰è£…æ–¹æ³•" class="headerlink" title="Linux å®‰è£…æ–¹æ³•"></a>Linux å®‰è£…æ–¹æ³•</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ Docker Compose</span></span><br><span class="line">sudo curl -L &quot;https://github.com/docker/compose/releases/download/v2.23.0/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ·»åŠ å¯æ‰§è¡Œæƒé™</span></span><br><span class="line">sudo chmod +x /usr/local/bin/docker-compose</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">éªŒè¯å®‰è£…</span></span><br><span class="line">docker-compose --version</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åº”è¾“å‡ºï¼šDocker Compose version v2.23.0</span></span><br></pre></td></tr></table></figure>

<h4 id="Windows-macOS-å®‰è£…"><a href="#Windows-macOS-å®‰è£…" class="headerlink" title="Windows&#x2F;macOS å®‰è£…"></a>Windows&#x2F;macOS å®‰è£…</h4><p>Windows å’Œ macOS çš„ Docker Desktop å·²åŒ…å« Docker Composeï¼Œæ— éœ€å•ç‹¬å®‰è£…ã€‚</p>
<h3 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h3><ol>
<li>**æœåŠ¡ (Service)**ï¼šä¸€ä¸ªå®¹å™¨åŒ–çš„åº”ç”¨ï¼ˆå¦‚ web æœåŠ¡å™¨ã€æ•°æ®åº“ï¼‰</li>
<li>**é¡¹ç›® (Project)**ï¼šç”±ä¸€ç»„å…³è”æœåŠ¡ç»„æˆçš„å®Œæ•´åº”ç”¨</li>
<li><strong>Compose æ–‡ä»¶</strong>ï¼šå®šä¹‰æœåŠ¡ã€ç½‘ç»œå’Œå·çš„ YAML æ–‡ä»¶</li>
</ol>
<h3 id="docker-compose-yml-æ–‡ä»¶ç»“æ„"><a href="#docker-compose-yml-æ–‡ä»¶ç»“æ„" class="headerlink" title="docker-compose.yml æ–‡ä»¶ç»“æ„"></a>docker-compose.yml æ–‡ä»¶ç»“æ„</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.9&quot;</span>  <span class="comment"># Compose æ–‡ä»¶æ ¼å¼ç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span>        <span class="comment"># å®šä¹‰æ‰€æœ‰æœåŠ¡</span></span><br><span class="line">  <span class="attr">web:</span>           <span class="comment"># æœåŠ¡åç§°</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:alpine</span>  <span class="comment"># ä½¿ç”¨çš„é•œåƒ</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span>  <span class="comment"># ç«¯å£æ˜ å°„</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./html:/usr/share/nginx/html</span>  <span class="comment"># å·æŒ‚è½½</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres:15</span></span><br><span class="line">    <span class="attr">environment:</span>  <span class="comment"># ç¯å¢ƒå˜é‡</span></span><br><span class="line">      <span class="attr">POSTGRES_PASSWORD:</span> <span class="string">example</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span>         <span class="comment"># å®šä¹‰å·</span></span><br><span class="line">  <span class="attr">db-data:</span>       <span class="comment"># å·åç§°</span></span><br></pre></td></tr></table></figure>

<h4 id="å…³é”®å­—æ®µ"><a href="#å…³é”®å­—æ®µ" class="headerlink" title="å…³é”®å­—æ®µ"></a>å…³é”®å­—æ®µ</h4><table>
<thead>
<tr>
<th align="left">å­—æ®µ</th>
<th align="left">è¯´æ˜</th>
<th align="left">ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>version</code></td>
<td align="left">Compose æ–‡ä»¶ç‰ˆæœ¬</td>
<td align="left"><code>&quot;3.9&quot;</code></td>
</tr>
<tr>
<td align="left"><code>services</code></td>
<td align="left">å®šä¹‰æ‰€æœ‰æœåŠ¡</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><code>image</code></td>
<td align="left">ä½¿ç”¨çš„ Docker é•œåƒ</td>
<td align="left"><code>nginx:alpine</code></td>
</tr>
<tr>
<td align="left"><code>build</code></td>
<td align="left">æ ¹æ® Dockerfile æ„å»ºé•œåƒ</td>
<td align="left"><code>context: ./dir</code></td>
</tr>
<tr>
<td align="left"><code>ports</code></td>
<td align="left">ç«¯å£æ˜ å°„</td>
<td align="left"><code>- &quot;8080:80&quot;</code></td>
</tr>
<tr>
<td align="left"><code>volumes</code></td>
<td align="left">å·æŒ‚è½½</td>
<td align="left"><code>- ./data:/app/data</code></td>
</tr>
<tr>
<td align="left"><code>environment</code></td>
<td align="left">è®¾ç½®ç¯å¢ƒå˜é‡</td>
<td align="left"><code>DEBUG: &quot;true&quot;</code></td>
</tr>
<tr>
<td align="left"><code>depends_on</code></td>
<td align="left">æœåŠ¡ä¾èµ–å…³ç³»</td>
<td align="left"><code>- db</code></td>
</tr>
<tr>
<td align="left"><code>networks</code></td>
<td align="left">åŠ å…¥çš„ç½‘ç»œ</td>
<td align="left"><code>- backend</code></td>
</tr>
</tbody></table>
<p>å¯åŠ¨åº”ç”¨ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><table>
<thead>
<tr>
<th align="left">å‘½ä»¤</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>docker-compose up</code></td>
<td align="left">åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡</td>
</tr>
<tr>
<td align="left"><code>docker-compose up -d</code></td>
<td align="left">åœ¨åå°è¿è¡ŒæœåŠ¡</td>
</tr>
<tr>
<td align="left"><code>docker-compose down</code></td>
<td align="left">åœæ­¢å¹¶ç§»é™¤æ‰€æœ‰å®¹å™¨ã€ç½‘ç»œ</td>
</tr>
<tr>
<td align="left"><code>docker-compose ps</code></td>
<td align="left">æŸ¥çœ‹è¿è¡Œä¸­çš„æœåŠ¡</td>
</tr>
<tr>
<td align="left"><code>docker-compose logs</code></td>
<td align="left">æŸ¥çœ‹æœåŠ¡æ—¥å¿—</td>
</tr>
<tr>
<td align="left"><code>docker-compose logs -f web</code></td>
<td align="left">å®æ—¶æŸ¥çœ‹ web æœåŠ¡æ—¥å¿—</td>
</tr>
<tr>
<td align="left"><code>docker-compose build</code></td>
<td align="left">æ„å»ºæˆ–é‡æ–°æ„å»ºæœåŠ¡é•œåƒ</td>
</tr>
<tr>
<td align="left"><code>docker-compose start</code></td>
<td align="left">å¯åŠ¨å·²å­˜åœ¨çš„æœåŠ¡</td>
</tr>
<tr>
<td align="left"><code>docker-compose stop</code></td>
<td align="left">åœæ­¢è¿è¡Œä¸­çš„æœåŠ¡</td>
</tr>
<tr>
<td align="left"><code>docker-compose restart</code></td>
<td align="left">é‡å¯æœåŠ¡</td>
</tr>
<tr>
<td align="left"><code>docker-compose exec web sh</code></td>
<td align="left">è¿›å…¥ web æœåŠ¡çš„å®¹å™¨</td>
</tr>
<tr>
<td align="left"><code>docker-compose pull</code></td>
<td align="left">æ‹‰å–æœåŠ¡çš„æœ€æ–°é•œåƒ</td>
</tr>
<tr>
<td align="left"><code>docker-compose config</code></td>
<td align="left">éªŒè¯ Compose æ–‡ä»¶æ ¼å¼</td>
</tr>
</tbody></table>
<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/681665911">ã€Dockerã€‘Docker Registry(é•œåƒä»“åº“) - çŸ¥ä¹</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/468642439">Docker æ•°æ®å­˜å‚¨ä¹‹ Volumes è¯¦è§£ - çŸ¥ä¹</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43980547/article/details/136914370">dockerå…¥é—¨ï¼ˆå…«ï¼‰â€”â€” dockerfileè¯¦ç»†ä»‹ç»ï¼Œç¼–å†™dockerfile-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-build-command.html">Docker build å‘½ä»¤ | èœé¸Ÿæ•™ç¨‹</a></p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-run-command.html">Docker run å‘½ä»¤ | èœé¸Ÿæ•™ç¨‹</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/YorkZach/p/18984794">Docker Compose æ•™ç¨‹ï¼šå®‰è£…ã€ä½¿ç”¨ä¸å¿«é€Ÿå…¥é—¨ - é”‹éœ² - åšå®¢å›­</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Natsuago/article/details/145588600">ä¸€ç¯‡å°±å¤Ÿï¼Windowsä¸ŠDocker Desktopå®‰è£… + æ±‰åŒ–å®Œæ•´æŒ‡å—ï¼ˆåŒ…å«è§£å†³wslæ›´æ–°å¤±è´¥æ–¹æ¡ˆï¼‰_dockeræ±‰åŒ–-CSDNåšå®¢</a></p>
</article><div class="post-copyright"><div class="post-copyright__author_group"><a class="post-copyright__author_img" href="/about/"><img class="post-copyright__author_img_front" src= "/img/spin.svg" data-lazy-src="/img/avatar.jpg"></a><div class="post-copyright__author_name">Rean's Blog</div><div class="post-copyright__author_desc">Enjoy technology and music</div></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div id="quit-box" onclick="RemoveRewardMask()"></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">æœ¬æ–‡æ˜¯åŸåˆ›æ–‡ç« ï¼Œé‡‡ç”¨<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>åè®®ï¼Œå®Œæ•´è½¬è½½è¯·æ³¨æ˜æ¥è‡ª<a href="/">Rean's Blog</a></span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__tag-list"></div></div></div><nav class="needEndHide pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/p/f2766b22/"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ã€ç»¼è¿°ã€‘LLM - Large Language Model</div></div></a></div><div class="next-post pull-right"><a href="/p/d2c104ef/"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">ã€æ˜Ÿå°˜Infinity/æœªæŠ’ã€‘é€†å…‰ï¼ˆCoverï¼šå‘¨æ·±/é™ˆæ¥šç”Ÿï¼‰ã€Synthesizer V Coverã€‘</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><div class="author-info__top-group"><div class="author-info__sayhi" id="author-info__sayhi" onclick="sco.changeSayHelloText()">sayhello.morning</div></div></div><div class="avatar-img-group"><img class="avatar-img" alt="å¤´åƒ" src= "/img/spin.svg" data-lazy-src="/img/avatar.jpg"><div class="avatar-sticker"><img class="avatar-sticker-img" src= "/img/spin.svg" data-lazy-src="https://7.isyangs.cn/34/65f2e4e0423cc-34.png" alt="å¿ƒæƒ…è´´çº¸"></div></div><div class="author-info__description_group"><div class="author-info__description">åˆ†äº«è‡ªå·±å¯¹ç¼–ç¨‹çš„<b>çƒ­çˆ±</b>ï¼Œå¯¹çŸ¥è¯†æµ·æ´‹<b>æ¢ç´¢å†ç¨‹</b>ï¼Œéšæœºæ‰è½<b>æ— å‚é…å¸ƒ</b>ä»¥åŠ<b>ç¿»è°ƒ</b>ï¼ˆä¸»è¦æ˜¯éŸ³ç»¼ç±»ï¼Œåœ¨Bç«™å› ä¸ºç‰ˆæƒåŸºæœ¬è¿‡ä¸äº†å®¡ï¼ˆã€‚</div><div class="author-info__description2">ç›¸ä¿¡ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å¯¹ä½ æœ‰ç”¨çš„çŸ¥è¯†å’Œæ•™ç¨‹ã€‚</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about/"><div class="author-info__name">Rean</div><div class="author-info__desc">Enjoy technology and music</div></a><div class="card-info-social-icons is-center"><a class="social-icon" target="_blank" rel="noopener" href="https://github.com/Rean-Schwarze" title="Github"><i class="solitude  st-github-line"></i></a><a class="social-icon" target="_blank" rel="noopener" href="https://space.bilibili.com/6531436" title="Bilibili"><i class="solitude  st-bilibili-line"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="solitude st-menu-line"></i><span>æ–‡ç« ç›®å½•</span></div><div class="toc-content" id="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#LLM-API"><span class="toc-text">LLM API</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#LLM-API-%E8%AF%B7%E6%B1%82%E4%BD%93%E5%8F%82%E6%95%B0"><span class="toc-text">LLM API è¯·æ±‚ä½“å‚æ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%8C%96%E8%BE%93%E5%87%BA"><span class="toc-text">ç»“æ„åŒ–è¾“å‡º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-text">ä½¿ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%AF%E6%8C%81%E7%9A%84-Schema"><span class="toc-text">æ”¯æŒçš„ Schema</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%AF%E6%8C%81%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-text">æ”¯æŒçš„å±æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#string"><span class="toc-text">string</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#number"><span class="toc-text">number</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#array"><span class="toc-text">array</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Json-%E6%A8%A1%E5%BC%8F"><span class="toc-text">Json æ¨¡å¼</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Tools"><span class="toc-text">ä½¿ç”¨ Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E7%94%A8%E7%9A%84-Tools"><span class="toc-text">å¯ç”¨çš„ Tools</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8"><span class="toc-text">å‡½æ•°è°ƒç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89"><span class="toc-text">å‡½æ•°å®šä¹‰</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E5%BC%8F%E5%93%8D%E5%BA%94"><span class="toc-text">æµå¼å“åº”</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Agent-Agno"><span class="toc-text">Agent - Agno</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Agent-%E5%88%9B%E5%BB%BA"><span class="toc-text">Agent åˆ›å»º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#OpenAI-Like-%E6%A8%A1%E5%9E%8B"><span class="toc-text">OpenAI Like æ¨¡å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C-Agent"><span class="toc-text">è¿è¡Œ Agent</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Agent-State"><span class="toc-text">Agent State</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%A8%E5%AF%B9%E8%AF%9D%E4%BF%9D%E6%8C%81%E7%8A%B6%E6%80%81"><span class="toc-text">è·¨å¯¹è¯ä¿æŒçŠ¶æ€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E6%8C%81%E4%B9%85%E5%8C%96%E4%BF%9D%E5%AD%98"><span class="toc-text">çŠ¶æ€æŒä¹…åŒ–ä¿å­˜</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Memory"><span class="toc-text">Memory</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-text">ç¤ºä¾‹ä»£ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E8%AF%9D%E6%80%BB%E7%BB%93"><span class="toc-text">ä¼šè¯æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tools"><span class="toc-text">Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%B7%B2%E6%9C%89-toolkit"><span class="toc-text">ä½¿ç”¨å·²æœ‰ toolkit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-Tools"><span class="toc-text">è‡ªå®šä¹‰ Tools</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%8C%96%E8%BE%93%E5%87%BA-1"><span class="toc-text">ç»“æ„åŒ–è¾“å‡º</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#FastAPI"><span class="toc-text">FastAPI</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#FastAPI-%E5%9F%BA%E6%9C%AC%E8%B7%AF%E7%94%B1"><span class="toc-text">FastAPI åŸºæœ¬è·¯ç”±</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E8%B7%AF%E5%BE%84%E8%B7%AF%E7%94%B1"><span class="toc-text">æ ¹è·¯å¾„è·¯ç”±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E5%8F%82%E6%95%B0"><span class="toc-text">è·¯å¾„å‚æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E4%BD%93"><span class="toc-text">è¯·æ±‚ä½“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%B4%E5%92%8C-Cookie"><span class="toc-text">è¯·æ±‚å¤´å’Œ Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-text">é‡å®šå‘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E7%A0%81"><span class="toc-text">é”™è¯¯ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%93%8D%E5%BA%94%E5%A4%B4"><span class="toc-text">è‡ªå®šä¹‰å“åº”å¤´</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E6%93%8D%E4%BD%9C%E4%BE%9D%E8%B5%96%E9%A1%B9"><span class="toc-text">è·¯å¾„æ“ä½œä¾èµ–é¡¹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-text">é¢„å¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E5%A4%84%E7%90%86"><span class="toc-text">åå¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E4%B8%AA%E4%BE%9D%E8%B5%96%E9%A1%B9%E7%BB%84%E5%90%88"><span class="toc-text">å¤šä¸ªä¾èµ–é¡¹ç»„åˆ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FastAPI-%E4%BA%A4%E4%BA%92%E5%BC%8F-API-%E6%96%87%E6%A1%A3"><span class="toc-text">FastAPI äº¤äº’å¼ API æ–‡æ¡£</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SSE"><span class="toc-text">SSE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SSE%E7%9A%84%E6%A0%B8%E5%BF%83%E4%BC%98%E5%8A%BF"><span class="toc-text">SSEçš„æ ¸å¿ƒä¼˜åŠ¿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FastAPI-SSE-%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-text">FastAPI SSE ç¤ºä¾‹ä»£ç </span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Docker"><span class="toc-text">Docker</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%EF%BC%88Image%EF%BC%89%E4%B8%8E%E5%AE%B9%E5%99%A8%EF%BC%88Container%EF%BC%89"><span class="toc-text">é•œåƒï¼ˆImageï¼‰ä¸å®¹å™¨ï¼ˆContainerï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%EF%BC%88Docker-Registry%EF%BC%89"><span class="toc-text">é•œåƒä»“åº“ï¼ˆDocker Registryï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dockerfile"><span class="toc-text">Dockerfile</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-text">ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F"><span class="toc-text">æ„å»ºé•œåƒ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%B9%E5%99%A8-vs-%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-text">å®¹å™¨ vs è™šæ‹Ÿæœº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%B7%EF%BC%88Volume%EF%BC%89"><span class="toc-text">å·ï¼ˆVolumeï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-volume"><span class="toc-text">åˆ›å»º volume</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B-volume"><span class="toc-text">æŸ¥çœ‹ volume</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4-volume"><span class="toc-text">åˆ é™¤ volume</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%82%E8%BD%BD%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%88%B0%E5%AE%B9%E5%99%A8%E7%9B%AE%E5%BD%95"><span class="toc-text">æŒ‚è½½æ•°æ®å·åˆ°å®¹å™¨ç›®å½•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="toc-text">å¯åŠ¨å®¹å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-Compose"><span class="toc-text">Docker Compose</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-text">å®‰è£…</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Linux-%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95"><span class="toc-text">Linux å®‰è£…æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows-macOS-%E5%AE%89%E8%A3%85"><span class="toc-text">Windows&#x2F;macOS å®‰è£…</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-text">æ ¸å¿ƒæ¦‚å¿µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-compose-yml-%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-text">docker-compose.yml æ–‡ä»¶ç»“æ„</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97%E6%AE%B5"><span class="toc-text">å…³é”®å­—æ®µ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-text">å¸¸ç”¨å‘½ä»¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-text">å‚è€ƒé“¾æ¥</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="solitude st-map-line"></i><span>æœ€è¿‘å‘å¸ƒ</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/p/f2766b22/" title="ã€ç»¼è¿°ã€‘LLM - Large Language Model"><img alt="ã€ç»¼è¿°ã€‘LLM - Large Language Model" src= "/img/spin.svg" data-lazy-src="https://npm.elemecdn.com/justlovesmile-photo/221228-15574975489aa1.jpg"></a><div class="content"><a class="title" href="/p/f2766b22/" title="ã€ç»¼è¿°ã€‘LLM - Large Language Model">ã€ç»¼è¿°ã€‘LLM - Large Language Model</a><a class="article-recent_post_categories" href="/p/f2766b22/">å­¦ä¹ </a></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/694e526e/" title="ã€Notesã€‘LLM API+Agent+FastAPI+SSE+Docker"><img alt="ã€Notesã€‘LLM API+Agent+FastAPI+SSE+Docker" src= "/img/spin.svg" data-lazy-src="https://npm.elemecdn.com/justlovesmile-photo/cover8.JPG"></a><div class="content"><a class="title" href="/p/694e526e/" title="ã€Notesã€‘LLM API+Agent+FastAPI+SSE+Docker">ã€Notesã€‘LLM API+Agent+FastAPI+SSE+Docker</a><a class="article-recent_post_categories" href="/p/694e526e/">å­¦ä¹ </a></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/d2c104ef/" title="ã€æ˜Ÿå°˜Infinity/æœªæŠ’ã€‘é€†å…‰ï¼ˆCoverï¼šå‘¨æ·±/é™ˆæ¥šç”Ÿï¼‰ã€Synthesizer V Coverã€‘"><img alt="ã€æ˜Ÿå°˜Infinity/æœªæŠ’ã€‘é€†å…‰ï¼ˆCoverï¼šå‘¨æ·±/é™ˆæ¥šç”Ÿï¼‰ã€Synthesizer V Coverã€‘" src= "/img/spin.svg" data-lazy-src="https://rean-song-bucket.oss-cn-guangzhou.aliyuncs.com/assets/cover/é€†å…‰_cover.png"></a><div class="content"><a class="title" href="/p/d2c104ef/" title="ã€æ˜Ÿå°˜Infinity/æœªæŠ’ã€‘é€†å…‰ï¼ˆCoverï¼šå‘¨æ·±/é™ˆæ¥šç”Ÿï¼‰ã€Synthesizer V Coverã€‘">ã€æ˜Ÿå°˜Infinity/æœªæŠ’ã€‘é€†å…‰ï¼ˆCoverï¼šå‘¨æ·±/é™ˆæ¥šç”Ÿï¼‰ã€Synthesizer V Coverã€‘</a><a class="article-recent_post_categories" href="/p/d2c104ef/">VOCALOIDÂ·UTAU</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/401d6e5a/" title="ã€æ°¸å¤œMinusã€‘ç ç‰ (live)ï¼ˆCoverï¼šå•ä¾çº¯ï¼‰ã€æ­Œæ‰‹2025ã€‘ã€Synthesizer V Coverã€‘"><img alt="ã€æ°¸å¤œMinusã€‘ç ç‰ (live)ï¼ˆCoverï¼šå•ä¾çº¯ï¼‰ã€æ­Œæ‰‹2025ã€‘ã€Synthesizer V Coverã€‘" src= "/img/spin.svg" data-lazy-src="https://rean-song-bucket.oss-cn-guangzhou.aliyuncs.com/assets/cover/ç ç‰_cover.jpg"></a><div class="content"><a class="title" href="/p/401d6e5a/" title="ã€æ°¸å¤œMinusã€‘ç ç‰ (live)ï¼ˆCoverï¼šå•ä¾çº¯ï¼‰ã€æ­Œæ‰‹2025ã€‘ã€Synthesizer V Coverã€‘">ã€æ°¸å¤œMinusã€‘ç ç‰ (live)ï¼ˆCoverï¼šå•ä¾çº¯ï¼‰ã€æ­Œæ‰‹2025ã€‘ã€Synthesizer V Coverã€‘</a><a class="article-recent_post_categories" href="/p/401d6e5a/">VOCALOIDÂ·UTAU</a></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/197094e3/" title="ã€å¢¨æ¸…å¼¦AIã€‘å”¯ä¸€ï¼ˆCoverï¼šG.E.M.é‚“ç´«æ£‹ï¼‰ã€ACE Coverã€‘"><img alt="ã€å¢¨æ¸…å¼¦AIã€‘å”¯ä¸€ï¼ˆCoverï¼šG.E.M.é‚“ç´«æ£‹ï¼‰ã€ACE Coverã€‘" src= "/img/spin.svg" data-lazy-src="https://rean-song-bucket.oss-cn-guangzhou.aliyuncs.com/assets/cover/å”¯ä¸€_cover.png"></a><div class="content"><a class="title" href="/p/197094e3/" title="ã€å¢¨æ¸…å¼¦AIã€‘å”¯ä¸€ï¼ˆCoverï¼šG.E.M.é‚“ç´«æ£‹ï¼‰ã€ACE Coverã€‘">ã€å¢¨æ¸…å¼¦AIã€‘å”¯ä¸€ï¼ˆCoverï¼šG.E.M.é‚“ç´«æ£‹ï¼‰ã€ACE Coverã€‘</a><a class="article-recent_post_categories" href="/p/197094e3/">VOCALOIDÂ·UTAU</a></div></div></div></div></div></div></main><footer id="footer"><div id="st-footer-bar"><div class="footer-logo"><span class="solitude">Rean's Blog</span></div><div class="footer-bar-description">æ¥è‡ªRean's Blog - Enjoy technology and musicçš„æ–‡ç« </div><a class="footer-bar-link" href="/">äº†è§£æ›´å¤š</a></div><div id="footer_deal"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/Rean-Schwarze" title="Github"><i class="solitude  st-github-line"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/6531436" title="Bilibili"><i class="solitude  st-bilibili-line"></i></a></div><div id="st-footer"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div class="copyright">Â© 2024 - 2025 By&nbsp;<a class="footer-bar-link" href="/">Rean</a></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/valor-x/hexo-theme-solitude" alt="ä¸»é¢˜">ä¸»é¢˜</a><a class="footer-bar-link cc" href="/null" aria-label="copyright"><i class="solitude st-copyright-line"></i><i class="solitude st-creative-commons-by-line"></i><i class="solitude st-creative-commons-nc-line"></i><i class="solitude st-creative-commons-nd-line"></i></a></div></div></div></footer></div><!-- right_menu--><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="solitude st-arrow-left-line"></i></div><div class="rightMenu-item" id="menu-forward"><i class="solitude st-arrow-right-line"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="solitude st-restart-line"></i></div><div class="rightMenu-item" id="menu-top"><i class="solitude st-arrow-up-line"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="solitude st-copy-fill"></i><span>å¤åˆ¶é€‰ä¸­æ–‡æœ¬</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="solitude st-clipboard-fill"></i><span>ç²˜è´´æ–‡æœ¬</span></div><div class="rightMenu-item" id="menu-newwindow"><i class="solitude st-window-fill"></i><span>æ–°çª—å£æ‰“å¼€</span></div><div class="rightMenu-item" id="menu-copylink"><i class="solitude st-link-line"></i><span>å¤åˆ¶é“¾æ¥åœ°å€</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="solitude st-copy-fill"></i><span>å¤åˆ¶æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="solitude st-download-cloud-fill"></i><span>ä¸‹è½½æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-search"><i class="solitude st-search-line"></i><span>ç«™å†…æœç´¢</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="solitude st-play-fill"></i><span>æ’­æ”¾éŸ³ä¹</span></div><div class="rightMenu-item" id="menu-music-back"><i class="solitude st-skip-back-fill"></i><span>åˆ‡æ¢åˆ°ä¸Šä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="solitude st-skip-forward-fill"></i><span>åˆ‡æ¢åˆ°ä¸‹ä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="solitude st-copy-fill"></i><span>å¤åˆ¶æ­Œå</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><div class="rightMenu-item" id="menu-randomPost" onclick="toRandomPost()||rm.hideRightMenu()"><i class="solitude st-signal-tower-fill"></i><span>éšæœºçŸ­æ–‡</span></div><div class="rightMenu-item" onclick="pjax.loadUrl('/categories/')||rm.hideRightMenu()"><i class="solitude st-checkbox-multiple-blank-fill"></i><span>å…¨éƒ¨åˆ†ç±»</span></div><div class="rightMenu-item" onclick="pjax.loadUrl('/tags/')||rm.hideRightMenu()"><i class="solitude st-price-tag-fill"></i><span>å…¨éƒ¨æ ‡ç­¾</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><div class="rightMenu-item" id="menu-darkmode" onclick="sco.switchDarkMode()"><i class="solitude st-moon-clear-fill"></i><span class="menu-darkmode-text">æ·±è‰²æ¨¡å¼</span></div><div class="rightMenu-item" id="menu-translate"><i class="solitude st-panben-line"></i><span>è½‰ç‚ºç¹é«”</span></div></div></div><div id="rightmenu-mask"></div><!-- inject body--><div><script src="/js/utils.js?v=1.8.10"></script><script src="/js/main.js?v=1.8.10"></script><script src="/js/third_party/waterfall.min.js?v=1.8.10"></script><script src="https://cdn.staticfile.net/pjax/0.2.8/pjax.min.js"></script><script src="/js/third_party/universe.min.js?v=1.8.10"></script><script>dark()
</script><script src="/js/tw_cn.js?v=1.8.10"></script><script src="https://cdn.staticfile.net/vanilla-lazyload/19.1.3/lazyload.iife.min.js"></script><script src="https://cdn.staticfile.net/node-snackbar/0.1.16/snackbar.min.js"></script><script src="https://cdn.staticfile.net/fancyapps-ui/5.0.36/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.staticfile.net/Swiper/11.0.5/swiper-bundle.min.js"></script><script>var meting_api = 'https://meting.qjqq.cn/?server=:server&type=:type&id=:id&auth=:auth&r=:r';</script><script src="https://cdn.staticfile.net/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn.staticfile.net/meting/2.0.1/Meting.min.js"></script><script>const coverColorConfig = {
    api: 'https://api.qjqq.cn/api/Imgcolor?img=',
    time: 43200000
}</script><script src="/js/covercolor/api.js?v=1.8.10"></script><script src="/js/music.js?v=1.8.10"></script><script src="https://cdn.staticfile.net/pace/1.2.4/pace.min.js"></script><script src="/js/right_menu.js?v=1.8.10"></script><div class="js-pjax"><script defer pjax src="https://cdn.staticfile.net/pearssauce-busuanzi/1.0.0/bsz.pure.min.js"></script></div></div><!-- newest comment--><!-- pjax--><script>const pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: ['title','#body-wrap','#site-config','meta[name="description"]','.js-pjax','meta[property^="og:"]','#config-diff'],
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
})

document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
})

document.addEventListener('pjax:complete', () => {
    window.refreshFn()

    document.querySelectorAll('script[data-pjax]').forEach(item => {
        const newScript = document.createElement('script')
        const content = item.text || item.textContent || item.innerHTML || ""
        Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
        newScript.appendChild(document.createTextNode(content))
        item.parentNode.replaceChild(newScript, item)
    })

    GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

})

document.addEventListener('pjax:error', (e) => {
    if (e.request.status === 404) {
        pjax.loadUrl('/404.html')
    }
})</script><!-- theme--><script>initTheme = () => {
    let isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const cachedMode = utils.saveToLocal.get('theme');
    if (cachedMode === undefined) {
        const nowMode =
            isDarkMode ? 'dark' : 'light'
        document.documentElement.setAttribute('data-theme', nowMode);
    } else {
        document.documentElement.setAttribute('data-theme', cachedMode);
    }
    is_rm && rm.mode(cachedMode === 'dark' && isDarkMode)
}
initTheme()</script><!-- google adsense--><!-- search--><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><button class="search-close-button"><i class="solitude st-close-fill"></i></button></nav><div class="search-wrap"><div class="search-box"><input class="search-box-input" id="search-input" type="text" autocomplete="off" spellcheck="false" autocorrect="off" autocapitalize="off" placeholder="è¾“å…¥å…³é”®è¯å¿«é€ŸæŸ¥æ‰¾"></div><div id="search-results"><div id="search-hits"></div></div><div id="search-pagination"></div><div id="search-tips"></div></div></div><div id="search-mask"></div></div><script src="/js/search/local.js?v=1.8.10"></script><!-- music--><div class="needEndHide" id="nav-music" onclick="sco.musicToggle()"><div id="nav-music-hoverTips">éŸ³ä¹å·²æš‚åœ</div><meting-js id="421801417" server="netease" type="playlist" mutex="true" preload="none" data-lrctype="0" order="random" theme="var(--efu-main)"></meting-js></div></body></html><script>const posts=["p/f2766b22/","p/694e526e/","p/d2c104ef/","p/401d6e5a/","p/197094e3/","p/867e546a/","p/9d906c2f/","p/8e8e2cc6/","p/2b6e13f/","p/e7845a78/","p/5871d67/","p/204d99f1/","p/b585efd0/","p/122902e7/","p/683f7c8e/","p/36b252a1/","p/bbd98f0d/","p/1b320550/","p/30cd73ca/","p/332adb42/","p/4f877c1e/","p/677c7789/","p/f7f0a5f3/","p/9b5a538c/","p/37360bc0/","p/bb996d5/","p/364ea8cc/","p/a027699d/","p/21cdaec5/","p/37c37880/","p/a02febe4/","p/d1ec0e4e/","p/25d2b878/","p/8324e4bc/","p/6021f67a/","p/305331f0/","p/66be4b4/","p/de2d10bc/","p/e6628f8e/","p/4131eeff/","p/27705e17/","p/74e1a37c/","p/b5223f80/","p/9b8bc45a/","p/c9cb7159/","p/82c942ab/","p/4c19fcc6/","p/27446c6a/","p/9f38852a/","p/2516f5f2/","p/b27c77b3/","p/7a3264f/","p/7beadfaa/","p/e1d9906f/","p/a440b512/","p/a46aa116/","p/fe8dd3bd/","p/51c99199/","p/91b418a/","p/421add40/","p/9d7a18c7/","p/26345198/","p/fa30e874/","p/dea9a817/","p/59203ba6/","p/e5616c72/","p/971e9859/","p/d7f6ccff/","p/1b2ec1c2/","p/a0d1cef9/","p/a58b6af0/","p/9381aa6d/","p/38b8becb/","p/d0a26095/","p/2b3bdada/","p/ba70636/","p/374630f5/","p/a964a243/","p/a06e9899/","p/ef9a99de/","p/108f7c52/","p/a91c1846/","p/413576cf/","p/9ee60c65/","p/e74db628/","p/888c8bf3/","p/477dbe08/","p/38e8a510/","p/dfb41864/","p/b0e3506b/","p/e17fd725/","p/e1fe458c/","p/636cfdea/","p/7b854cb7/","p/b3a61240/","p/64f43fb4/","p/800f9a11/","p/4a48b34c/","p/b3641215/","p/53bc1fc9/","p/fc02f9ee/","p/25b929f6/","p/dd30b42/","p/3aa261db/","p/fc078742/","p/22c9d1d0/","p/33fc02d2/","p/70335ae0/","p/f32ef110/","p/f756486c/","p/8dd4b91f/","p/a290d941/","p/61a8a4ef/","p/c2d0bb20/","p/9770d71c/","p/41bd2aed/","p/bfebe40b/","p/6b4006e6/","p/b5696360/","p/53ab7115/","p/e6fa9b9/","p/866abf45/","p/b718b92a/","p/d26f4c21/","p/bc5d6bbe/","p/5a18917b/","p/5f2b1e2f/","p/2532a2ee/","p/4337b2c0/","p/e042d029/","p/9b4a91e5/","p/9d8ce868/","p/a69f6a48/","p/f9b9edb2/","p/cbe55d0/","p/156c59d0/","p/d4d6f818/","p/2574cf15/","p/a0efc292/","p/ec2ecf28/","p/85f11265/","p/db95e6f5/","p/a8296e6d/","p/4cc89a71/","p/d0fe2d0f/","p/ffab2f6b/","p/95d9f91e/","p/7f869365/","p/5b246b1b/","p/a9c92fa9/","p/7d49fec0/","p/a9a25fcd/","p/43bb383e/","p/b9aeb4/","p/52eaf228/","p/4be90d2f/","p/ed500d41/","p/dcfbc8e5/","p/240e5e52/","p/18cda1b3/","p/66a6c396/","p/5f33341/","p/f9bef31e/","p/acac46b/","p/a4189438/","p/ae6b0147/","p/4e982f2d/","p/403e0cac/","p/495b9f0f/","p/8e966ab9/","p/f6e1007e/","p/6f562d19/","p/10eac329/","p/cc53cf58/","p/4f2beac6/","p/73e2aa1/","p/c677e75e/","p/3f13b766/","p/cc30f00/","p/807cab5e/","p/5b5991e4/","p/e941ffc/"];function toRandomPost(){ pjax.loadUrl('/'+posts[Math.floor(Math.random()*posts.length)]); }</script>